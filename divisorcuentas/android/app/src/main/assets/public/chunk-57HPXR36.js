import{a as it,e as nt,g as ot}from"./chunk-T277TTWP.js";import{a as rt}from"./chunk-JLZ2UVSU.js";import{a as at}from"./chunk-ULNDTA5Q.js";import{$ as j,A as p,B as m,C as b,D as C,E,F as k,H as M,I as v,J as _,K as V,L as T,N as F,P as B,R,S as D,W as N,X as z,Y as L,Z as W,_ as Q,aa as $,ba as H,ca as q,d as f,e as h,f as x,fa as G,g as r,ha as J,i as I,ia as K,k as g,la as U,ma as X,q as s,qa as Y,r as a,ra as Z,s as o,t as y,u as P,v as w,w as u,wa as tt,x as S,xa as et,y as O,z as A}from"./chunk-BXOCLV3Y.js";import"./chunk-4LE76BWB.js";import"./chunk-73UBTZ6U.js";import"./chunk-QY5AYREC.js";import"./chunk-22BFWSH3.js";import"./chunk-JRVP6ISR.js";import"./chunk-YQTF3JKO.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-H3Z6NBHK.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-VZEDPC34.js";var ct=["selectRef"],lt=i=>["/participantes",i],st=i=>["/items",i];function dt(i,c){if(i&1&&(a(0,"div",23)(1,"div",19)(2,"p",24),p(3),o()()()),i&2){let t=c.$implicit;r(3),m(t.name)}}function mt(i,c){if(i&1&&(a(0,"li",32),p(1),o()),i&2){let t=c.$implicit;r(),b(" ",t," ")}}function gt(i,c){if(i&1&&(a(0,"div")(1,"span",30),p(2,"Asignado a:"),o(),y(3,"br"),g(4,mt,2,1,"li",31),o()),i&2){let t=u().$implicit;r(4),s("ngForOf",t.participant)}}function ut(i,c){if(i&1&&(a(0,"option",33),p(1),o()),i&2){let t=c.$implicit;s("ngValue",t.name),r(),m(t.name)}}function vt(i,c){if(i&1){let t=P();a(0,"div",17)(1,"div",18)(2,"div",19)(3,"p"),p(4),o(),g(5,gt,5,1,"div",4),o(),a(6,"div",20)(7,"label",21),p(8),v(9,"clpCurrency"),o(),y(10,"br"),a(11,"div",25)(12,"button",26)(13,"span",27),p(14,"person_add"),o()(),a(15,"select",28,0),k("ngModelChange",function(n){let l=h(t).$implicit;return E(l.participant,n)||(l.participant=n),x(n)}),w("ngModelChange",function(){h(t);let n=u(2);return x(n.calcularMontoApagar())}),g(17,ut,2,2,"option",29),o()()()()()}if(i&2){let t=c.$implicit,e=u(2);r(4),m(t.name),r(),s("ngIf",t.participant.length>0),r(3),m(_(9,5,t.price)),r(7),C("ngModel",t.participant),r(2),s("ngForOf",e.evento.participants)}}function _t(i,c){if(i&1&&(a(0,"div",17)(1,"div",18)(2,"div",19)(3,"p"),p(4,"Propina"),o()(),a(5,"div",20)(6,"label",21),p(7),v(8,"clpCurrency"),o()()()()),i&2){let t=u(2);r(7),m(_(8,1,t.propina()))}}function ft(i,c){if(i&1){let t=P();a(0,"div")(1,"label",34)(2,"input",35),k("ngModelChange",function(n){h(t);let l=u(2);return E(l.incluyePropina,n)||(l.incluyePropina=n),x(n)}),w("change",function(){h(t);let n=u(2);return x(n.calcularMontoApagar())}),o(),a(3,"p",36),p(4,"Incluye propina"),o()()()}if(i&2){let t=u(2);r(2),C("ngModel",t.incluyePropina)}}function ht(i,c){if(i&1&&(a(0,"div",37)(1,"div",18)(2,"div",19)(3,"p"),p(4),o()(),a(5,"div")(6,"td",38),p(7),v(8,"clpCurrency"),o()()()()),i&2){let t=c.$implicit;r(4),m(t.name),r(3),b("",_(8,2,t.montoApagar)," ")}}function xt(i,c){if(i&1&&(a(0,"ion-content")(1,"div")(2,"p"),p(3),o(),a(4,"div",5)(5,"section")(6,"ion-accordion-group")(7,"ion-accordion",6)(8,"ion-item",7)(9,"strong"),p(10,"Participantes:"),o()(),a(11,"div",8)(12,"div",9),g(13,dt,4,1,"div",10),o()()()(),a(14,"div",11)(15,"button",12),p(16," Editar Participantes "),o()()(),a(17,"section",13)(18,"ion-item",7)(19,"strong"),p(20,"Items:"),o()(),a(21,"div",14),g(22,vt,18,7,"div",15)(23,_t,9,3,"div",16),a(24,"div",17)(25,"div",18)(26,"div",19)(27,"p"),p(28,"Total"),o()(),a(29,"div",20)(30,"label",21),p(31),v(32,"clpCurrency"),o()()()()(),a(33,"div",11)(34,"button",12),p(35," Editar items "),o()()(),g(36,ft,5,1,"div",4),o(),a(37,"div",5)(38,"ion-item",7)(39,"strong"),p(40,"Detalle por participante:"),o()(),a(41,"section",13)(42,"div",14),g(43,ht,9,4,"div",22),a(44,"div",17)(45,"div",18)(46,"div",19)(47,"strong"),p(48,"Total"),o()(),a(49,"div")(50,"strong"),p(51),v(52,"clpCurrency"),o()()()()()()(),y(53,"br")(54,"br")(55,"br"),o()()),i&2){let t=u();r(3),b(" ",t.evento.description," "),r(10),s("ngForOf",t.evento.participants),r(2),s("routerLink",M(14,lt,t.evento.id)),r(7),s("ngForOf",t.evento.items),r(),s("ngIf",t.incluyePropina),r(8),m(_(32,10,t.total())),r(3),s("routerLink",M(16,st,t.evento.id)),r(2),s("ngIf",t.evento.items&&t.evento.items.length>0),r(7),s("ngForOf",t.evento.participants),r(8),m(_(52,12,t.totalAsignado()))}}var zt=(()=>{let c=class c{goToParticipantes(){this.router.navigate(["/participantes"])}constructor(){this.selectRefsArr=[],this.cuadraturaValida=!0,this.data=f(at),this.activatedRoute=f(B),this.platform=f(q),this.router=f(R),this.incluyePropina=!1,this.nuevoParticipante="",it({personCircle:nt,trashOutline:ot})}ngOnInit(){let e=this.activatedRoute.snapshot.paramMap.get("id");this.evento=this.data.getEvents().find(n=>n.id===parseInt(e,10)),this.incluyePropina=this.evento.incluyePropina,this.calcularMontoApagar(),this.evento.items&&this.evento.items.forEach(n=>{Array.isArray(n.participant)||(n.participant=[])})}ngAfterViewInit(){this.selectRefsArr=this.selectRefs?this.selectRefs.toArray():[]}calcularMontoApagar(){!this.evento||!this.evento.items||(this.evento.incluyePropina=this.incluyePropina,this.evento.participants.forEach(e=>e.montoApagar=0),this.evento.items.forEach(e=>{if(Array.isArray(e.participant)&&e.participant.length>0){let n=e.price/e.participant.length;e.participant.forEach(l=>{let d=this.evento.participants.find(pt=>pt.name===l);d&&(d.montoApagar+=n)})}}),this.incluyePropina&&this.evento.participants.forEach(e=>e.montoApagar*=1.1),this.data.saveEvents(),this.cuadraturaValida=Math.abs(this.totalAsignado()-this.total())<1)}eliminarParticipante(e){this.evento.participants&&e>-1&&this.evento.participants.splice(e,1)}subtotal(){return this.evento?.items?.reduce((e,n)=>e+n.price,0)||0}propina(){return this.subtotal()*.1}total(){var e=this.subtotal();return this.incluyePropina&&(e=e*1.1),e}getTotalPorParticipante(e){if(!this.evento||!this.evento.items)return 0;var n=this.evento.items.filter(l=>{let d=l.participant;return d?Array.isArray(d)?d.includes(e.name):d===e.name:!1}).reduce((l,d)=>l+d.price,0);return this.incluyePropina&&(n*=1.1),n}totalAsignado(){return this.evento?.participants?.reduce((e,n)=>e+n.montoApagar,0)||0}getBackButtonText(){return this.platform.is("ios")?"Eventos":""}agregarParticipante(){if(!(!this.nuevoParticipante||!this.nuevoParticipante.trim())){this.evento.participants||(this.evento.participants=[]);var e={name:this.nuevoParticipante.trim(),montoApagar:0,pagado:!1};this.evento.participants.push(e),this.nuevoParticipante=""}}};c.\u0275fac=function(n){return new(n||c)},c.\u0275cmp=I({type:c,selectors:[["app-view-evento"]],viewQuery:function(n,l){if(n&1&&S(ct,5),n&2){let d;O(d=A())&&(l.selectRefs=d)}},decls:7,vars:4,consts:[["selectRef",""],[3,"translucent"],["slot","start"],["defaultHref","/home",3,"text"],[4,"ngIf"],[1,"participants-section"],["value","first"],["slot","header"],["slot","content",1,"ion-padding"],[1,"space-y-2",2,"width","100%"],["class","flex items-center gap-4 p-3 rounded-lg bg-white dark:bg-background-dark/50","style","background-color: #06192D;",4,"ngFor","ngForOf"],[1,"mt-4","flex","justify-end"],[1,"bg-primary/20","dark:bg-primary/30","text-primary","font-bold","py-2","px-4","rounded-lg","text-sm",3,"routerLink"],[1,"mt-8"],[1,"space-y-4"],["class","p-4 rounded-lg bg-white dark:bg-background-dark/50 space-y-3","style","background-color: #06192D;",4,"ngFor","ngForOf"],["class","p-4 rounded-lg bg-white dark:bg-background-dark/50 space-y-3","style","background-color: #06192D;",4,"ngIf"],[1,"p-4","rounded-lg","bg-white","dark:bg-background-dark/50","space-y-3",2,"background-color","#06192D"],[1,"flex","items-center","gap-4"],[1,"flex-grow"],[2,"display","block","text-align","center"],[2,"margin","auto"],["class","p-4 rounded-lg dark:bg-background-dark/50 space-y-3","style","background-color: #06192D;",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-4","p-3","rounded-lg","bg-white","dark:bg-background-dark/50",2,"background-color","#06192D"],[1,"font-semibold","dark:text-white"],[2,"position","relative","display","inline-block","width","40px","height","40px"],[1,"p-2","-mr-2","text-gray-500","dark:text-gray-400","hover:text-primary","dark:hover:text-primary",2,"width","40px","height","40px","position","absolute","left","0","top","0","z-index","1","pointer-events","none"],[1,"material-symbols-outlined"],["multiple","true","id","assign-decoracion",2,"opacity","0","position","absolute","left","0","top","0","width","40px","height","40px","z-index","2","cursor","pointer",3,"ngModelChange","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],[2,"font-size","small"],["style","margin-left: 5rem;font-size: small;",4,"ngFor","ngForOf"],[2,"margin-left","5rem","font-size","small"],[3,"ngValue"],[1,"flex","gap-x-3","py-3","items-center"],["type","checkbox",1,"h-5","w-5","rounded-lg","border-2","bg-transparent","text-primary","checked:bg-primary","checked:border-primary","checked:bg-[image:--checkbox-tick-svg]","focus:ring-0","focus:ring-offset-0","focus:border-[#1A5A96]","border-[#1A5A96]",3,"ngModelChange","change","ngModel"],[1,"text-white","text-base","font-normal","leading-normal"],[1,"p-4","rounded-lg","dark:bg-background-dark/50","space-y-3",2,"background-color","#06192D"],[1,"text-sm","shrink-0",2,"float","inline-end"]],template:function(n,l){n&1&&(a(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),p(3),o(),a(4,"ion-buttons",2),y(5,"ion-back-button",3),o()()(),g(6,xt,56,18,"ion-content",4)),n&2&&(s("translucent",!0),r(3),m(l.evento.title),r(2),s("text",l.getBackButtonText()),r(),s("ngIf",l.evento))},dependencies:[K,Z,J,tt,Y,et,U,G,X,F,V,T,H,Q,$,z,j,L,W,N,D,rt],styles:["ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--background: transparent;--inner-border-width: 0 !important}ion-label[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px}ion-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:600;display:flex;flex-wrap:wrap;justify-content:space-between}ion-item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{align-items:center;display:flex}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:42px;margin-right:8px}ion-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:.9375rem;margin-right:12px;font-weight:400}ion-content[_ngcontent-%COMP%]{--padding-top: 0;--padding-bottom: 0}.items-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.items-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .items-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;border:1px solid #eee}.items-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left}.participants-section[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem;width:100%;padding:5%}.flex-grow[_ngcontent-%COMP%]{width:33%}"]});let i=c;return i})();export{zt as ViewEventoPage};
