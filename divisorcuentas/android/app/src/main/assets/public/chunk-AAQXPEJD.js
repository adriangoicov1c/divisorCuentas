import{a as eo}from"./chunk-JLZ2UVSU.js";import{a as Zs}from"./chunk-ULNDTA5Q.js";import{A as ie,Aa as Qs,B as Pn,Ba as Ys,C as As,D as Cn,E as vn,F as En,G as Ps,H as Cs,I as vs,J as Es,K as Ss,L as Rs,N as Os,P as ks,S as Ts,W as $s,Y as Ms,Z as Fs,ba as Ls,d as Lr,e as ne,f as se,g as oe,ga as Ns,i as ys,k as Nr,ka as Us,la as Bs,ma as Sn,na as js,oa as Ds,pa as qs,q as ve,qa as Ws,r as M,ra as Hs,s as U,sa as Vs,t as fe,u as Yt,ua as Js,v as de,va as Ks,w as me,wa as Gs,x as ws,xa as Xs,y as xs,z as Is,za as zs}from"./chunk-BXOCLV3Y.js";import"./chunk-4LE76BWB.js";import"./chunk-73UBTZ6U.js";import"./chunk-QY5AYREC.js";import"./chunk-22BFWSH3.js";import"./chunk-JRVP6ISR.js";import"./chunk-YQTF3JKO.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-H3Z6NBHK.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as i,b as c,e as O,h as Qt,i as d,j as X,k as _e,l as bs,m as W}from"./chunk-VZEDPC34.js";var Zt=(function(n){return n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE",n})(Zt||{}),Ee=class extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}},ai=n=>{var e,t;return n?.androidBridge?"android":!((t=(e=n?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},li=n=>{let e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},s=()=>e!==null?e.name:ai(n),o=()=>s()!=="web",a=g=>{let _=m.get(g);return!!(_?.platforms.has(s())||l(g))},l=g=>{var _;return(_=t.PluginHeaders)===null||_===void 0?void 0:_.find(b=>b.name===g)},h=g=>n.console.error(g),m=new Map,x=(g,_={})=>{let b=m.get(g);if(b)return console.warn(`Capacitor plugin "${g}" already registered. Cannot register plugins twice.`),b.proxy;let w=s(),B=l(g),T,k=()=>d(null,null,function*(){return!T&&w in _?T=typeof _[w]=="function"?T=yield _[w]():T=_[w]:e!==null&&!T&&"web"in _&&(T=typeof _.web=="function"?T=yield _.web():T=_.web),T}),A=($,S)=>{var R,q;if(B){let Y=B?.methods.find(N=>S===N.name);if(Y)return Y.rtype==="promise"?N=>t.nativePromise(g,S.toString(),N):(N,ee)=>t.nativeCallback(g,S.toString(),N,ee);if($)return(R=$[S])===null||R===void 0?void 0:R.bind($)}else{if($)return(q=$[S])===null||q===void 0?void 0:q.bind($);throw new Ee(`"${g}" plugin is not implemented on ${w}`,Zt.Unimplemented)}},F=$=>{let S,R=(...q)=>{let Y=k().then(N=>{let ee=A(N,$);if(ee){let te=ee(...q);return S=te?.remove,te}else throw new Ee(`"${g}.${$}()" is not implemented on ${w}`,Zt.Unimplemented)});return $==="addListener"&&(Y.remove=()=>d(null,null,function*(){return S()})),Y};return R.toString=()=>`${$.toString()}() { [capacitor code] }`,Object.defineProperty(R,"name",{value:$,writable:!1,configurable:!1}),R},j=F("addListener"),D=F("removeListener"),v=($,S)=>{let R=j({eventName:$},S),q=()=>d(null,null,function*(){let N=yield R;D({eventName:$,callbackId:N},S)}),Y=new Promise(N=>R.then(()=>N({remove:q})));return Y.remove=()=>d(null,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield q()}),Y},L=new Proxy({},{get($,S){switch(S){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return B?v:j;case"removeListener":return D;default:return F(S)}}});return r[g]=L,m.set(g,{name:g,proxy:L,platforms:new Set([...Object.keys(_),...B?[w]:[]])}),L};return t.convertFileSrc||(t.convertFileSrc=g=>g),t.getPlatform=s,t.handleError=h,t.isNativePlatform=o,t.isPluginAvailable=a,t.registerPlugin=x,t.Exception=Ee,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},ci=n=>n.Capacitor=li(n),Rn=ci(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Ur=Rn.registerPlugin,st=class{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);let o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),r&&this.sendRetainedArgumentsForEvent(e);let a=()=>d(this,null,function*(){return this.removeListener(e,t)});return Promise.resolve({remove:a})}removeAllListeners(){return d(this,null,function*(){this.listeners={};for(let e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}})}notifyListeners(e,t,r){let s=this.listeners[e];if(!s){if(r){let o=this.retainedEventArguments[e];o||(o=[]),o.push(t),this.retainedEventArguments[e]=o}return}s.forEach(o=>o(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new Rn.Exception(e,Zt.Unimplemented)}unavailable(e="not available"){return new Rn.Exception(e,Zt.Unavailable)}removeListener(e,t){return d(this,null,function*(){let r=this.listeners[e];if(!r)return;let s=r.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])})}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){let t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}};var to=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ro=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent),On=class extends st{getCookies(){return d(this,null,function*(){let e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,o]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=ro(s).trim(),o=ro(o).trim(),t[s]=o}),t})}setCookie(e){return d(this,null,function*(){try{let t=to(e.key),r=to(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),a=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${s}; path=${o}; ${a};`}catch(t){return Promise.reject(t)}})}deleteCookie(e){return d(this,null,function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})}clearCookies(){return d(this,null,function*(){try{let e=document.cookie.split(";")||[];for(let t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})}clearAllCookies(){return d(this,null,function*(){try{yield this.clearCookies()}catch(e){return Promise.reject(e)}})}},Ka=Ur("CapacitorCookies",{web:()=>new On}),ui=n=>d(null,null,function*(){return new Promise((e,t)=>{let r=new FileReader;r.onload=()=>{let s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>t(s),r.readAsDataURL(n)})}),di=(n={})=>{let e=Object.keys(n);return Object.keys(n).map(s=>s.toLocaleLowerCase()).reduce((s,o,a)=>(s[o]=n[e[a]],s),{})},fi=(n,e=!0)=>n?Object.entries(n).reduce((r,s)=>{let[o,a]=s,l,h;return Array.isArray(a)?(h="",a.forEach(m=>{l=e?encodeURIComponent(m):m,h+=`${o}=${l}&`}),h.slice(0,-1)):(l=e?encodeURIComponent(a):a,h=`${o}=${l}`),`${r}&${h}`},"").substr(1):null,mi=(n,e={})=>{let t=Object.assign({method:n.method||"GET",headers:n.headers},e),s=di(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(s.includes("application/x-www-form-urlencoded")){let o=new URLSearchParams;for(let[a,l]of Object.entries(n.data||{}))o.set(a,l);t.body=o.toString()}else if(s.includes("multipart/form-data")||n.data instanceof FormData){let o=new FormData;if(n.data instanceof FormData)n.data.forEach((l,h)=>{o.append(h,l)});else for(let l of Object.keys(n.data))o.append(l,n.data[l]);t.body=o;let a=new Headers(t.headers);a.delete("content-type"),t.headers=a}else(s.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t},kn=class extends st{request(e){return d(this,null,function*(){let t=mi(e,e.webFetchExtra),r=fi(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,o=yield fetch(s,t),a=o.headers.get("content-type")||"",{responseType:l="text"}=o.ok?e:{};a.includes("application/json")&&(l="json");let h,m;switch(l){case"arraybuffer":case"blob":m=yield o.blob(),h=yield ui(m);break;case"json":h=yield o.json();break;case"document":case"text":default:h=yield o.text()}let x={};return o.headers.forEach((g,_)=>{x[_]=g}),{data:h,headers:x,status:o.status,url:o.url}})}get(e){return d(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))})}post(e){return d(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))})}put(e){return d(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))})}patch(e){return d(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})}delete(e){return d(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})}},Ga=Ur("CapacitorHttp",{web:()=>new kn});var be=(function(n){return n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS",n})(be||{}),er=(function(n){return n.Rear="REAR",n.Front="FRONT",n})(er||{}),Tn=(function(n){return n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl",n})(Tn||{});var tr=class extends st{getPhoto(e){return d(this,null,function*(){return new Promise((t,r)=>d(this,null,function*(){if(e.webUseInput||e.source===be.Photos)this.fileInputExperience(e,t,r);else if(e.source===be.Prompt){let s=document.querySelector("pwa-action-sheet");s||(s=document.createElement("pwa-action-sheet"),document.body.appendChild(s)),s.header=e.promptLabelHeader||"Photo",s.cancelable=!1,s.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],s.addEventListener("onSelection",o=>d(this,null,function*(){o.detail===0?this.fileInputExperience(e,t,r):this.cameraExperience(e,t,r)}))}else this.cameraExperience(e,t,r)}))})}pickImages(e){return d(this,null,function*(){return new Promise((t,r)=>d(this,null,function*(){this.multipleFileInputExperience(t,r)}))})}cameraExperience(e,t,r){return d(this,null,function*(){if(customElements.get("pwa-camera-modal")){let s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===er.Front?"user":"environment",document.body.appendChild(s);try{yield s.componentOnReady(),s.addEventListener("onPhoto",o=>d(this,null,function*(){let a=o.detail;a===null?r(new Ee("User cancelled photos app")):a instanceof Error?r(a):t(yield this._getCameraPhoto(a,e)),s.dismiss(),document.body.removeChild(s)})),s.present()}catch{this.fileInputExperience(e,t,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,t,r)})}fileInputExperience(e,t,r){let s=document.querySelector("#_capacitor-camera-input"),o=()=>{var a;(a=s.parentNode)===null||a===void 0||a.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input",s.type="file",s.hidden=!0,document.body.appendChild(s),s.addEventListener("change",a=>{let l=s.files[0],h="jpeg";if(l.type==="image/png"?h="png":l.type==="image/gif"&&(h="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){let m=new FileReader;m.addEventListener("load",()=>{if(e.resultType==="dataUrl")t({dataUrl:m.result,format:h});else if(e.resultType==="base64"){let x=m.result.split(",")[1];t({base64String:x,format:h})}o()}),m.readAsDataURL(l)}else t({webPath:URL.createObjectURL(l),format:h}),o()}),s.addEventListener("cancel",a=>{r(new Ee("User cancelled photos app")),o()})),s.accept="image/*",s.capture=!0,e.source===be.Photos||e.source===be.Prompt?s.removeAttribute("capture"):e.direction===er.Front?s.capture="user":e.direction===er.Rear&&(s.capture="environment"),s.click()}multipleFileInputExperience(e,t){let r=document.querySelector("#_capacitor-camera-input-multiple"),s=()=>{var o;(o=r.parentNode)===null||o===void 0||o.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",o=>{let a=[];for(let l=0;l<r.files.length;l++){let h=r.files[l],m="jpeg";h.type==="image/png"?m="png":h.type==="image/gif"&&(m="gif"),a.push({webPath:URL.createObjectURL(h),format:m})}e({photos:a}),s()}),r.addEventListener("cancel",o=>{t(new Ee("User cancelled photos app")),s()})),r.accept="image/*",r.click()}_getCameraPhoto(e,t){return new Promise((r,s)=>{let o=new FileReader,a=e.type.split("/")[1];t.resultType==="uri"?r({webPath:URL.createObjectURL(e),format:a,saved:!1}):(o.readAsDataURL(e),o.onloadend=()=>{let l=o.result;t.resultType==="dataUrl"?r({dataUrl:l,format:a,saved:!1}):r({base64String:l.split(",")[1],format:a,saved:!1})},o.onerror=l=>{s(l)})})}checkPermissions(){return d(this,null,function*(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return d(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return d(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return d(this,null,function*(){throw this.unavailable("Not implemented on web.")})}},el=new tr;var no=Ur("Camera",{web:()=>new tr});var ot=typeof import.meta<"u"?import.meta.env:typeof process<"u"?process.env:{},je={production:!0,geminiApiKey:ot.VITE_GEMINI_API_KEY??"",azure:{endpoint:ot.VITE_AZURE_OPENAI_ENDPOINT??"",apiKey:ot.VITE_AZURE_OPENAI_API_KEY??"",deployment:ot.VITE_AZURE_OPENAI_DEPLOYMENT??"",apiVersion:ot.VITE_AZURE_OPENAI_API_VERSION??"",model:ot.VITE_AZURE_OPENAI_MODEL??""}};function P(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function u(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}var $n=function(){let{crypto:n}=globalThis;if(n?.randomUUID)return $n=n.randomUUID.bind(n),n.randomUUID();let e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^t()&15>>+r/4).toString(16))};function rr(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}var nr=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){let e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};var I=class extends Error{},J=class n extends I{constructor(e,t,r,s){super(`${n.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.requestID=s?.get("x-request-id"),this.error=t;let o=t;this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(e,t,r){let s=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new Me({message:r,cause:nr(t)});let o=t?.error;return e===400?new it(e,o,r,s):e===401?new at(e,o,r,s):e===403?new lt(e,o,r,s):e===404?new ct(e,o,r,s):e===409?new ut(e,o,r,s):e===422?new dt(e,o,r,s):e===429?new ft(e,o,r,s):e>=500?new mt(e,o,r,s):new n(e,o,r,s)}},V=class extends J{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},Me=class extends J{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}},Fe=class extends Me{constructor({message:e}={}){super({message:e??"Request timed out."})}},it=class extends J{},at=class extends J{},lt=class extends J{},ct=class extends J{},ut=class extends J{},dt=class extends J{},ft=class extends J{},mt=class extends J{},pt=class extends I{constructor(){super("Could not parse response content as the length limit was reached")}},ht=class extends I{constructor(){super("Could not parse response content as the request was rejected by the content filter")}},ye=class extends Error{constructor(e){super(e)}};var hi=/^[a-z][a-z0-9+.-]*:/i,so=n=>hi.test(n),Z=n=>(Z=Array.isArray,Z(n)),Mn=Z;function Fn(n){return typeof n!="object"?{}:n??{}}function oo(n){if(!n)return!0;for(let e in n)return!1;return!0}function io(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function gt(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}var ao=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new I(`${n} must be an integer`);if(e<0)throw new I(`${n} must be a positive integer`);return e};var lo=n=>{try{return JSON.parse(n)}catch{return}};var we=n=>new Promise(e=>setTimeout(e,n));var Le="6.9.1";var mo=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function gi(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}var _i=()=>{let n=gi();if(n==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Le,"X-Stainless-OS":uo(Deno.build.os),"X-Stainless-Arch":co(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Le,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(n==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Le,"X-Stainless-OS":uo(globalThis.process.platform??"unknown"),"X-Stainless-Arch":co(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let e=bi();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Le,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Le,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function bi(){if(typeof navigator>"u"||!navigator)return null;let n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:t}of n){let r=t.exec(navigator.userAgent);if(r){let s=r[1]||0,o=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${o}.${a}`}}}return null}var co=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",uo=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown"),fo,po=()=>fo??(fo=_i());function ho(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Ln(...n){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function Br(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return Ln({start(){},pull(r){return d(this,null,function*(){let{done:s,value:o}=yield e.next();s?r.close():r.enqueue(o)})},cancel(){return d(this,null,function*(){yield e.return?.()})}})}function Nn(n){if(n[Symbol.asyncIterator])return n;let e=n.getReader();return{next(){return d(this,null,function*(){try{let r=yield e.read();return r?.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}})},return(){return d(this,null,function*(){let r=e.cancel();return e.releaseLock(),yield r,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}function go(n){return d(this,null,function*(){if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){yield n[Symbol.asyncIterator]().return?.();return}let e=n.getReader(),t=e.cancel();e.releaseLock(),yield t})}var _o=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});var jr="RFC3986",Un=n=>String(n),Dr={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:Un},Bn="RFC1738";var qr=(n,e)=>(qr=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),qr(n,e)),xe=(()=>{let n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})();var jn=1024,bo=(n,e,t,r,s)=>{if(n.length===0)return n;let o=n;if(typeof n=="symbol"?o=Symbol.prototype.toString.call(n):typeof n!="string"&&(o=String(n)),t==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let a="";for(let l=0;l<o.length;l+=jn){let h=o.length>=jn?o.slice(l,l+jn):o,m=[];for(let x=0;x<h.length;++x){let g=h.charCodeAt(x);if(g===45||g===46||g===95||g===126||g>=48&&g<=57||g>=65&&g<=90||g>=97&&g<=122||s===Bn&&(g===40||g===41)){m[m.length]=h.charAt(x);continue}if(g<128){m[m.length]=xe[g];continue}if(g<2048){m[m.length]=xe[192|g>>6]+xe[128|g&63];continue}if(g<55296||g>=57344){m[m.length]=xe[224|g>>12]+xe[128|g>>6&63]+xe[128|g&63];continue}x+=1,g=65536+((g&1023)<<10|h.charCodeAt(x)&1023),m[m.length]=xe[240|g>>18]+xe[128|g>>12&63]+xe[128|g>>6&63]+xe[128|g&63]}a+=m.join("")}return a};function yo(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function Dn(n,e){if(Z(n)){let t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}var xo={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},Io=function(n,e){Array.prototype.push.apply(n,Z(e)?e:[e])},wo,K={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:bo,encodeValuesOnly:!1,format:jr,formatter:Un,indices:!1,serializeDate(n){return(wo??(wo=Function.prototype.call.bind(Date.prototype.toISOString)))(n)},skipNulls:!1,strictNullHandling:!1};function xi(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}var qn={};function Ao(n,e,t,r,s,o,a,l,h,m,x,g,_,b,w,B,T,k){let A=n,F=k,j=0,D=!1;for(;(F=F.get(qn))!==void 0&&!D;){let R=F.get(n);if(j+=1,typeof R<"u"){if(R===j)throw new RangeError("Cyclic object value");D=!0}typeof F.get(qn)>"u"&&(j=0)}if(typeof m=="function"?A=m(e,A):A instanceof Date?A=_?.(A):t==="comma"&&Z(A)&&(A=Dn(A,function(R){return R instanceof Date?_?.(R):R})),A===null){if(o)return h&&!B?h(e,K.encoder,T,"key",b):e;A=""}if(xi(A)||yo(A)){if(h){let R=B?e:h(e,K.encoder,T,"key",b);return[w?.(R)+"="+w?.(h(A,K.encoder,T,"value",b))]}return[w?.(e)+"="+w?.(String(A))]}let v=[];if(typeof A>"u")return v;let L;if(t==="comma"&&Z(A))B&&h&&(A=Dn(A,h)),L=[{value:A.length>0?A.join(",")||null:void 0}];else if(Z(m))L=m;else{let R=Object.keys(A);L=x?R.sort(x):R}let $=l?String(e).replace(/\./g,"%2E"):String(e),S=r&&Z(A)&&A.length===1?$+"[]":$;if(s&&Z(A)&&A.length===0)return S+"[]";for(let R=0;R<L.length;++R){let q=L[R],Y=typeof q=="object"&&typeof q.value<"u"?q.value:A[q];if(a&&Y===null)continue;let N=g&&l?q.replace(/\./g,"%2E"):q,ee=Z(A)?typeof t=="function"?t(S,N):S:S+(g?"."+N:"["+N+"]");k.set(n,j);let te=new WeakMap;te.set(qn,k),Io(v,Ao(Y,ee,t,r,s,o,a,l,t==="comma"&&B&&Z(A)?null:h,m,x,g,_,b,w,B,T,te))}return v}function Ii(n=K){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");let e=n.charset||K.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=jr;if(typeof n.format<"u"){if(!qr(Dr,n.format))throw new TypeError("Unknown format option provided.");t=n.format}let r=Dr[t],s=K.filter;(typeof n.filter=="function"||Z(n.filter))&&(s=n.filter);let o;if(n.arrayFormat&&n.arrayFormat in xo?o=n.arrayFormat:"indices"in n?o=n.indices?"indices":"repeat":o=K.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");let a=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:K.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:K.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:K.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:K.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?K.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:K.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:K.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:K.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:K.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:K.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:K.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:K.strictNullHandling}}function Wn(n,e={}){let t=n,r=Ii(e),s,o;typeof r.filter=="function"?(o=r.filter,t=o("",t)):Z(r.filter)&&(o=r.filter,s=o);let a=[];if(typeof t!="object"||t===null)return"";let l=xo[r.arrayFormat],h=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);let m=new WeakMap;for(let _=0;_<s.length;++_){let b=s[_];r.skipNulls&&t[b]===null||Io(a,Ao(t[b],b,l,h,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,m))}let x=a.join(r.delimiter),g=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?g+="utf8=%26%2310003%3B&":g+="utf8=%E2%9C%93&"),x.length>0?g+x:""}function vo(n){let e=0;for(let s of n)e+=s.length;let t=new Uint8Array(e),r=0;for(let s of n)t.set(s,r),r+=s.length;return t}var Po;function _t(n){let e;return(Po??(e=new globalThis.TextEncoder,Po=e.encode.bind(e)))(n)}var Co;function Hn(n){let e;return(Co??(e=new globalThis.TextDecoder,Co=e.decode.bind(e)))(n)}var ae,le,De=class{constructor(){ae.set(this,void 0),le.set(this,void 0),P(this,ae,new Uint8Array,"f"),P(this,le,null,"f")}decode(e){if(e==null)return[];let t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?_t(e):e;P(this,ae,vo([u(this,ae,"f"),t]),"f");let r=[],s;for(;(s=Pi(u(this,ae,"f"),u(this,le,"f")))!=null;){if(s.carriage&&u(this,le,"f")==null){P(this,le,s.index,"f");continue}if(u(this,le,"f")!=null&&(s.index!==u(this,le,"f")+1||s.carriage)){r.push(Hn(u(this,ae,"f").subarray(0,u(this,le,"f")-1))),P(this,ae,u(this,ae,"f").subarray(u(this,le,"f")),"f"),P(this,le,null,"f");continue}let o=u(this,le,"f")!==null?s.preceding-1:s.preceding,a=Hn(u(this,ae,"f").subarray(0,o));r.push(a),P(this,ae,u(this,ae,"f").subarray(s.index),"f"),P(this,le,null,"f")}return r}flush(){return u(this,ae,"f").length?this.decode(`
`):[]}};ae=new WeakMap,le=new WeakMap;De.NEWLINE_CHARS=new Set([`
`,"\r"]);De.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Pi(n,e){for(let s=e??0;s<n.length;s++){if(n[s]===10)return{preceding:s,index:s+1,carriage:!1};if(n[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Eo(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}var Hr={off:0,error:200,warn:300,info:400,debug:500},Vn=(n,e,t)=>{if(n){if(io(Hr,n))return n;H(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Hr))}`)}};function sr(){}function Wr(n,e,t){return!e||Hr[n]>Hr[t]?sr:e[n].bind(e)}var Ci={error:sr,warn:sr,info:sr,debug:sr},So=new WeakMap;function H(n){let e=n.logger,t=n.logLevel??"off";if(!e)return Ci;let r=So.get(e);if(r&&r[0]===t)return r[1];let s={error:Wr("error",e,t),warn:Wr("warn",e,t),info:Wr("info",e,t),debug:Wr("debug",e,t)};return So.set(e,[t,s]),s}var Se=n=>(n.options&&(n.options=i({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);var or,Ie=class n{constructor(e,t,r){this.iterator=e,or.set(this,void 0),this.controller=t,P(this,or,r,"f")}static fromSSEResponse(e,t,r){let s=!1,o=r?H(r):console;function a(){return _e(this,null,function*(){if(s)throw new I("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let l=!1;try{try{for(var h=W(vi(e,t)),m,x,g;m=!(x=yield new X(h.next())).done;m=!1){let _=x.value;if(!l){if(_.data.startsWith("[DONE]")){l=!0;continue}if(_.event===null||!_.event.startsWith("thread.")){let b;try{b=JSON.parse(_.data)}catch(w){throw o.error("Could not parse message into JSON:",_.data),o.error("From chunk:",_.raw),w}if(b&&b.error)throw new J(void 0,b.error,void 0,e.headers);yield b}else{let b;try{b=JSON.parse(_.data)}catch(w){throw console.error("Could not parse message into JSON:",_.data),console.error("From chunk:",_.raw),w}if(_.event=="error")throw new J(void 0,b.error,b.message,void 0);yield{event:_.event,data:b}}}}}catch{g=[x]}finally{try{m&&(x=h.return)&&(yield new X(x.call(h)))}finally{if(g)throw g[0]}}l=!0}catch(_){if(rr(_))return;throw _}finally{l||t.abort()}})}return new n(a,t,r)}static fromReadableStream(e,t,r){let s=!1;function o(){return _e(this,null,function*(){let l=new De,h=Nn(e);try{for(var m=W(h),x,g,_;x=!(g=yield new X(m.next())).done;x=!1){let b=g.value;for(let w of l.decode(b))yield w}}catch{_=[g]}finally{try{x&&(g=m.return)&&(yield new X(g.call(m)))}finally{if(_)throw _[0]}}for(let b of l.flush())yield b})}function a(){return _e(this,null,function*(){if(s)throw new I("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let l=!1;try{try{for(var h=W(o()),m,x,g;m=!(x=yield new X(h.next())).done;m=!1){let _=x.value;l||_&&(yield JSON.parse(_))}}catch{g=[x]}finally{try{m&&(x=h.return)&&(yield new X(x.call(h)))}finally{if(g)throw g[0]}}l=!0}catch(_){if(rr(_))return;throw _}finally{l||t.abort()}})}return new n(a,t,r)}[(or=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],r=this.iterator(),s=o=>({next:()=>{if(o.length===0){let a=r.next();e.push(a),t.push(a)}return o.shift()}});return[new n(()=>s(e),this.controller,u(this,or,"f")),new n(()=>s(t),this.controller,u(this,or,"f"))]}toReadableStream(){let e=this,t;return Ln({start(){return d(this,null,function*(){t=e[Symbol.asyncIterator]()})},pull(s){return d(this,null,function*(){try{let{value:o,done:a}=yield t.next();if(a)return s.close();let l=_t(JSON.stringify(o)+`
`);s.enqueue(l)}catch(o){s.error(o)}})},cancel(){return d(this,null,function*(){yield t.return?.()})}})}};function vi(n,e){return _e(this,null,function*(){if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new I("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new I("Attempted to iterate over a response with no body");let t=new Jn,r=new De,s=Nn(n.body);try{for(var o=W(Ei(s)),a,l,h;a=!(l=yield new X(o.next())).done;a=!1){let m=l.value;for(let x of r.decode(m)){let g=t.decode(x);g&&(yield g)}}}catch{h=[l]}finally{try{a&&(l=o.return)&&(yield new X(l.call(o)))}finally{if(h)throw h[0]}}for(let m of r.flush()){let x=t.decode(m);x&&(yield x)}})}function Ei(n){return _e(this,null,function*(){let e=new Uint8Array;try{for(var t=W(n),r,s,o;r=!(s=yield new X(t.next())).done;r=!1){let a=s.value;if(a==null)continue;let l=a instanceof ArrayBuffer?new Uint8Array(a):typeof a=="string"?_t(a):a,h=new Uint8Array(e.length+l.length);h.set(e),h.set(l,e.length),e=h;let m;for(;(m=Eo(e))!==-1;)yield e.slice(0,m),e=e.slice(m)}}catch{o=[s]}finally{try{r&&(s=t.return)&&(yield new X(s.call(t)))}finally{if(o)throw o[0]}}e.length>0&&(yield e)})}var Jn=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=Si(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}};function Si(n,e){let t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}function Vr(n,e){return d(this,null,function*(){let{response:t,requestLogID:r,retryOfRequestLogID:s,startTime:o}=e,a=yield d(null,null,function*(){if(e.options.stream)return H(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):Ie.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;let h=t.headers.get("content-type")?.split(";")[0]?.trim();if(h?.includes("application/json")||h?.endsWith("+json")){let g=yield t.json();return Kn(g,t)}return yield t.text()});return H(n).debug(`[${r}] response parsed`,Se({retryOfRequestLogID:s,url:t.url,status:t.status,body:a,durationMs:Date.now()-o})),a})}function Kn(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var ir,qe=class n extends Promise{constructor(e,t,r=Vr){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=r,ir.set(this,void 0),P(this,ir,e,"f")}_thenUnwrap(e){return new n(u(this,ir,"f"),this.responsePromise,(t,r)=>d(this,null,function*(){return Kn(e(yield this.parseResponse(t,r),r),r.response)}))}asResponse(){return this.responsePromise.then(e=>e.response)}withResponse(){return d(this,null,function*(){let[e,t]=yield Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}})}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(u(this,ir,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};ir=new WeakMap;var Jr,ar=class{constructor(e,t,r,s){Jr.set(this,void 0),P(this,Jr,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}getNextPage(){return d(this,null,function*(){let e=this.nextPageRequestOptions();if(!e)throw new I("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return yield u(this,Jr,"f").requestAPIList(this.constructor,e)})}iterPages(){return _e(this,null,function*(){let e=this;for(yield e;e.hasNextPage();)e=yield new X(e.getNextPage()),yield e})}[(Jr=new WeakMap,Symbol.asyncIterator)](){return _e(this,null,function*(){try{for(var e=W(this.iterPages()),t,r,s;t=!(r=yield new X(e.next())).done;t=!1){let o=r.value;for(let a of o.getPaginatedItems())yield a}}catch{s=[r]}finally{try{t&&(r=e.return)&&(yield new X(r.call(e)))}finally{if(s)throw s[0]}}})}},lr=class extends qe{constructor(e,t,r){super(e,t,(s,o)=>d(null,null,function*(){return new r(s,o.response,yield Vr(s,o),o.options)}))}[Symbol.asyncIterator](){return _e(this,null,function*(){let e=yield new X(this);try{for(var t=W(e),r,s,o;r=!(s=yield new X(t.next())).done;r=!1){let a=s.value;yield a}}catch{o=[s]}finally{try{r&&(s=t.return)&&(yield new X(s.call(t)))}finally{if(o)throw o[0]}}})}},Ae=class extends ar{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}},E=class extends ar{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){let e=this.getPaginatedItems(),t=e[e.length-1]?.id;return t?c(i({},this.options),{query:c(i({},Fn(this.options.query)),{after:t})}):null}},Re=class extends ar{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){let e=this.last_id;return e?c(i({},this.options),{query:c(i({},Fn(this.options.query)),{after:e})}):null}};var zn=()=>{if(typeof File>"u"){let{process:n}=globalThis,e=typeof n?.versions?.node=="string"&&parseInt(n.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function bt(n,e,t){return zn(),new File(n,e??"unknown_file",t)}function cr(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}var Kr=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Qn=(n,e)=>d(null,null,function*(){return Gn(n.body)?c(i({},n),{body:yield Oo(n.body,e)}):n}),ce=(n,e)=>d(null,null,function*(){return c(i({},n),{body:yield Oo(n.body,e)})}),Ro=new WeakMap;function Oi(n){let e=typeof n=="function"?n:n.fetch,t=Ro.get(e);if(t)return t;let r=d(null,null,function*(){try{let s="Response"in e?e.Response:(yield e("data:,")).constructor,o=new FormData;return o.toString()!==(yield new s(o).text())}catch{return!0}});return Ro.set(e,r),r}var Oo=(n,e)=>d(null,null,function*(){if(!(yield Oi(e)))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let t=new FormData;return yield Promise.all(Object.entries(n||{}).map(([r,s])=>Xn(t,r,s))),t}),ko=n=>n instanceof Blob&&"name"in n,ki=n=>typeof n=="object"&&n!==null&&(n instanceof Response||Kr(n)||ko(n)),Gn=n=>{if(ki(n))return!0;if(Array.isArray(n))return n.some(Gn);if(n&&typeof n=="object"){for(let e in n)if(Gn(n[e]))return!0}return!1},Xn=(n,e,t)=>d(null,null,function*(){if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(t instanceof Response)n.append(e,bt([yield t.blob()],cr(t)));else if(Kr(t))n.append(e,bt([yield new Response(Br(t)).blob()],cr(t)));else if(ko(t))n.append(e,t,cr(t));else if(Array.isArray(t))yield Promise.all(t.map(r=>Xn(n,e+"[]",r)));else if(typeof t=="object")yield Promise.all(Object.entries(t).map(([r,s])=>Xn(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}});var To=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",Ti=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&To(n),$i=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";function Gr(n,e,t){return d(this,null,function*(){if(zn(),n=yield n,Ti(n))return n instanceof File?n:bt([yield n.arrayBuffer()],n.name);if($i(n)){let s=yield n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),bt(yield Yn(s),e,t)}let r=yield Yn(n);if(e||(e=cr(n)),!t?.type){let s=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(t=c(i({},t),{type:s}))}return bt(r,e,t)})}function Yn(n){return d(this,null,function*(){let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(To(n))e.push(n instanceof Blob?n:yield n.arrayBuffer());else if(Kr(n))try{for(var t=W(n),r,s,o;r=!(s=yield t.next()).done;r=!1){let a=s.value;e.push(...yield Yn(a))}}catch{o=[s]}finally{try{r&&(s=t.return)&&(yield s.call(t))}finally{if(o)throw o[0]}}else{let a=n?.constructor?.name;throw new Error(`Unexpected data type: ${typeof n}${a?`; constructor: ${a}`:""}${Mi(n)}`)}return e})}function Mi(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}var p=class{constructor(e){this._client=e}};function Mo(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}var $o=Object.freeze(Object.create(null)),Li=(n=Mo)=>function(t,...r){if(t.length===1)return t[0];let s=!1,o=[],a=t.reduce((x,g,_)=>{/[?#]/.test(g)&&(s=!0);let b=r[_],w=(s?encodeURIComponent:n)(""+b);return _!==r.length&&(b==null||typeof b=="object"&&b.toString===Object.getPrototypeOf(Object.getPrototypeOf(b.hasOwnProperty??$o)??$o)?.toString)&&(w=b+"",o.push({start:x.length+g.length,length:w.length,error:`Value of type ${Object.prototype.toString.call(b).slice(8,-1)} is not a valid path parameter`})),x+g+(_===r.length?"":w)},""),l=a.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi"),m;for(;(m=h.exec(l))!==null;)o.push({start:m.index,length:m[0].length,error:`Value "${m[0]}" can't be safely passed as a path parameter`});if(o.sort((x,g)=>x.start-g.start),o.length>0){let x=0,g=o.reduce((_,b)=>{let w=" ".repeat(b.start-x),B="^".repeat(b.length);return x=b.start+b.length,_+w+B},"");throw new I(`Path parameters result in path with invalid segments:
${o.map(_=>_.error).join(`
`)}
${a}
${g}`)}return a},f=Li(Mo);var We=class extends p{list(e,t={},r){return this._client.getAPIList(f`/chat/completions/${e}/messages`,E,i({query:t},r))}};function ur(n){return n!==void 0&&"function"in n&&n.function!==void 0}function dr(n){return n?.$brand==="auto-parseable-response-format"}function He(n){return n?.$brand==="auto-parseable-tool"}function Fo(n,e){return!e||!Zn(e)?c(i({},n),{choices:n.choices.map(t=>(No(t.message.tool_calls),c(i({},t),{message:i(c(i({},t.message),{parsed:null}),t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0)})))}):fr(n,e)}function fr(n,e){let t=n.choices.map(r=>{if(r.finish_reason==="length")throw new pt;if(r.finish_reason==="content_filter")throw new ht;return No(r.message.tool_calls),c(i({},r),{message:c(i(i({},r.message),r.message.tool_calls?{tool_calls:r.message.tool_calls?.map(s=>ji(e,s))??void 0}:void 0),{parsed:r.message.content&&!r.message.refusal?Bi(e,r.message.content):null})})});return c(i({},n),{choices:t})}function Bi(n,e){return n.response_format?.type!=="json_schema"?null:n.response_format?.type==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function ji(n,e){let t=n.tools?.find(r=>ur(r)&&r.function?.name===e.function.name);return c(i({},e),{function:c(i({},e.function),{parsed_arguments:He(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null})})}function Lo(n,e){if(!n||!("tools"in n)||!n.tools)return!1;let t=n.tools?.find(r=>ur(r)&&r.function?.name===e.function.name);return ur(t)&&(He(t)||t?.function.strict||!1)}function Zn(n){return dr(n.response_format)?!0:n.tools?.some(e=>He(e)||e.type==="function"&&e.function.strict===!0)??!1}function No(n){for(let e of n||[])if(e.type!=="function")throw new I(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function Uo(n){for(let e of n??[]){if(e.type!=="function")throw new I(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new I(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var yt=n=>n?.role==="assistant",es=n=>n?.role==="tool";var ts,Xr,zr,mr,pr,Qr,hr,Oe,gr,Yr,Zr,wt,Bo,Ne=class{constructor(){ts.add(this),this.controller=new AbortController,Xr.set(this,void 0),zr.set(this,()=>{}),mr.set(this,()=>{}),pr.set(this,void 0),Qr.set(this,()=>{}),hr.set(this,()=>{}),Oe.set(this,{}),gr.set(this,!1),Yr.set(this,!1),Zr.set(this,!1),wt.set(this,!1),P(this,Xr,new Promise((e,t)=>{P(this,zr,e,"f"),P(this,mr,t,"f")}),"f"),P(this,pr,new Promise((e,t)=>{P(this,Qr,e,"f"),P(this,hr,t,"f")}),"f"),u(this,Xr,"f").catch(()=>{}),u(this,pr,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},u(this,ts,"m",Bo).bind(this))},0)}_connected(){this.ended||(u(this,zr,"f").call(this),this._emit("connect"))}get ended(){return u(this,gr,"f")}get errored(){return u(this,Yr,"f")}get aborted(){return u(this,Zr,"f")}abort(){this.controller.abort()}on(e,t){return(u(this,Oe,"f")[e]||(u(this,Oe,"f")[e]=[])).push({listener:t}),this}off(e,t){let r=u(this,Oe,"f")[e];if(!r)return this;let s=r.findIndex(o=>o.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(u(this,Oe,"f")[e]||(u(this,Oe,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{P(this,wt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}done(){return d(this,null,function*(){P(this,wt,!0,"f"),yield u(this,pr,"f")})}_emit(e,...t){if(u(this,gr,"f"))return;e==="end"&&(P(this,gr,!0,"f"),u(this,Qr,"f").call(this));let r=u(this,Oe,"f")[e];if(r&&(u(this,Oe,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){let s=t[0];!u(this,wt,"f")&&!r?.length&&Promise.reject(s),u(this,mr,"f").call(this,s),u(this,hr,"f").call(this,s),this._emit("end");return}if(e==="error"){let s=t[0];!u(this,wt,"f")&&!r?.length&&Promise.reject(s),u(this,mr,"f").call(this,s),u(this,hr,"f").call(this,s),this._emit("end")}}_emitFinal(){}};Xr=new WeakMap,zr=new WeakMap,mr=new WeakMap,pr=new WeakMap,Qr=new WeakMap,hr=new WeakMap,Oe=new WeakMap,gr=new WeakMap,Yr=new WeakMap,Zr=new WeakMap,wt=new WeakMap,ts=new WeakSet,Bo=function(e){if(P(this,Yr,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new V),e instanceof V)return P(this,Zr,!0,"f"),this._emit("abort",e);if(e instanceof I)return this._emit("error",e);if(e instanceof Error){let t=new I(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new I(String(e)))};function jo(n){return typeof n.parse=="function"}var re,rs,en,ns,ss,os,Do,qo,Di=10,xt=class extends Ne{constructor(){super(...arguments),re.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),es(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(yt(e)&&e.tool_calls)for(let r of e.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}finalChatCompletion(){return d(this,null,function*(){yield this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new I("stream ended without producing a ChatCompletion");return e})}finalContent(){return d(this,null,function*(){return yield this.done(),u(this,re,"m",rs).call(this)})}finalMessage(){return d(this,null,function*(){return yield this.done(),u(this,re,"m",en).call(this)})}finalFunctionToolCall(){return d(this,null,function*(){return yield this.done(),u(this,re,"m",ns).call(this)})}finalFunctionToolCallResult(){return d(this,null,function*(){return yield this.done(),u(this,re,"m",ss).call(this)})}totalUsage(){return d(this,null,function*(){return yield this.done(),u(this,re,"m",os).call(this)})}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=u(this,re,"m",en).call(this);t&&this._emit("finalMessage",t);let r=u(this,re,"m",rs).call(this);r&&this._emit("finalContent",r);let s=u(this,re,"m",ns).call(this);s&&this._emit("finalFunctionToolCall",s);let o=u(this,re,"m",ss).call(this);o!=null&&this._emit("finalFunctionToolCallResult",o),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",u(this,re,"m",os).call(this))}_createChatCompletion(e,t,r){return d(this,null,function*(){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),u(this,re,"m",Do).call(this,t);let o=yield e.chat.completions.create(c(i({},t),{stream:!1}),c(i({},r),{signal:this.controller.signal}));return this._connected(),this._addChatCompletion(fr(o,t))})}_runChatCompletion(e,t,r){return d(this,null,function*(){for(let s of t.messages)this._addMessage(s,!1);return yield this._createChatCompletion(e,t,r)})}_runTools(e,t,r){return d(this,null,function*(){let s="tool",b=t,{tool_choice:o="auto",stream:a}=b,l=O(b,["tool_choice","stream"]),h=typeof o!="string"&&o.type==="function"&&o?.function?.name,{maxChatCompletions:m=Di}=r||{},x=t.tools.map(w=>{if(He(w)){if(!w.$callback)throw new I("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:w.$callback,name:w.function.name,description:w.function.description||"",parameters:w.function.parameters,parse:w.$parseRaw,strict:!0}}}return w}),g={};for(let w of x)w.type==="function"&&(g[w.function.name||w.function.function.name]=w.function);let _="tools"in t?x.map(w=>w.type==="function"?{type:"function",function:{name:w.function.name||w.function.function.name,parameters:w.function.parameters,description:w.function.description,strict:w.function.strict}}:w):void 0;for(let w of t.messages)this._addMessage(w,!1);for(let w=0;w<m;++w){let T=(yield this._createChatCompletion(e,c(i({},l),{tool_choice:o,tools:_,messages:[...this.messages]}),r)).choices[0]?.message;if(!T)throw new I("missing message in ChatCompletion response");if(!T.tool_calls?.length)return;for(let k of T.tool_calls){if(k.type!=="function")continue;let A=k.id,{name:F,arguments:j}=k.function,D=g[F];if(D){if(h&&h!==F){let S=`Invalid tool_call: ${JSON.stringify(F)}. ${JSON.stringify(h)} requested. Please try again`;this._addMessage({role:s,tool_call_id:A,content:S});continue}}else{let S=`Invalid tool_call: ${JSON.stringify(F)}. Available options are: ${Object.keys(g).map(R=>JSON.stringify(R)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:A,content:S});continue}let v;try{v=jo(D)?yield D.parse(j):j}catch(S){let R=S instanceof Error?S.message:String(S);this._addMessage({role:s,tool_call_id:A,content:R});continue}let L=yield D.function(v,this),$=u(this,re,"m",qo).call(this,L);if(this._addMessage({role:s,tool_call_id:A,content:$}),h)return}}})}};re=new WeakSet,rs=function(){return u(this,re,"m",en).call(this).content??null},en=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(yt(t))return c(i({},t),{content:t.content??null,refusal:t.refusal??null})}throw new I("stream ended without producing a ChatCompletionMessage with role=assistant")},ns=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(yt(t)&&t?.tool_calls?.length)return t.tool_calls.filter(r=>r.type==="function").at(-1)?.function}},ss=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(es(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>r.role==="assistant"&&r.tool_calls?.some(s=>s.type==="function"&&s.id===t.tool_call_id)))return t.content}},os=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Do=function(e){if(e.n!=null&&e.n>1)throw new I("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},qo=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};var _r=class n extends xt{static runTools(e,t,r){let s=new n,o=c(i({},r),{headers:c(i({},r?.headers),{"X-Stainless-Helper-Method":"runTools"})});return s._run(()=>s._runTools(e,t,o)),s}_addMessage(e,t=!0){super._addMessage(e,t),yt(e)&&e.content&&this._emit("content",e.content)}};var z={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511},is=class extends Error{},as=class extends Error{};function qi(n,e=z.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return Wi(n.trim(),e)}var Wi=(n,e)=>{let t=n.length,r=0,s=_=>{throw new is(`${_} at position ${r}`)},o=_=>{throw new as(`${_} at position ${r}`)},a=()=>(g(),r>=t&&s("Unexpected end of input"),n[r]==='"'?l():n[r]==="{"?h():n[r]==="["?m():n.substring(r,r+4)==="null"||z.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||z.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||z.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||z.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||z.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||z.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):x()),l=()=>{let _=r,b=!1;for(r++;r<t&&(n[r]!=='"'||b&&n[r-1]==="\\");)b=n[r]==="\\"?!b:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(_,++r-Number(b)))}catch(w){o(String(w))}else if(z.STR&e)try{return JSON.parse(n.substring(_,r-Number(b))+'"')}catch{return JSON.parse(n.substring(_,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},h=()=>{r++,g();let _={};try{for(;n[r]!=="}";){if(g(),r>=t&&z.OBJ&e)return _;let b=l();g(),r++;try{let w=a();Object.defineProperty(_,b,{value:w,writable:!0,enumerable:!0,configurable:!0})}catch(w){if(z.OBJ&e)return _;throw w}g(),n[r]===","&&r++}}catch{if(z.OBJ&e)return _;s("Expected '}' at end of object")}return r++,_},m=()=>{r++;let _=[];try{for(;n[r]!=="]";)_.push(a()),g(),n[r]===","&&r++}catch{if(z.ARR&e)return _;s("Expected ']' at end of array")}return r++,_},x=()=>{if(r===0){n==="-"&&z.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(b){if(z.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}o(String(b))}}let _=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(z.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(_,r))}catch{n.substring(_,r)==="-"&&z.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(_,n.lastIndexOf("e")))}catch(w){o(String(w))}}},g=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return a()},ls=n=>qi(n,z.ALL^z.NUM);var G,ke,It,Ue,cs,tn,us,ds,fs,rn,ms,Wo,Ve=class n extends xt{constructor(e){super(),G.add(this),ke.set(this,void 0),It.set(this,void 0),Ue.set(this,void 0),P(this,ke,e,"f"),P(this,It,[],"f")}get currentChatCompletionSnapshot(){return u(this,Ue,"f")}static fromReadableStream(e){let t=new n(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){let s=new n(t);return s._run(()=>s._runChatCompletion(e,c(i({},t),{stream:!0}),c(i({},r),{headers:c(i({},r?.headers),{"X-Stainless-Helper-Method":"stream"})}))),s}_createChatCompletion(e,t,r){return d(this,null,function*(){Qt(n.prototype,this,"_createChatCompletion");let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),u(this,G,"m",cs).call(this);let o=yield e.chat.completions.create(c(i({},t),{stream:!0}),c(i({},r),{signal:this.controller.signal}));this._connected();try{for(var a=W(o),l,h,m;l=!(h=yield a.next()).done;l=!1){let x=h.value;u(this,G,"m",us).call(this,x)}}catch{m=[h]}finally{try{l&&(h=a.return)&&(yield h.call(a))}finally{if(m)throw m[0]}}if(o.controller.signal?.aborted)throw new V;return this._addChatCompletion(u(this,G,"m",rn).call(this))})}_fromReadableStream(e,t){return d(this,null,function*(){let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),u(this,G,"m",cs).call(this),this._connected();let s=Ie.fromReadableStream(e,this.controller),o;try{for(var a=W(s),l,h,m;l=!(h=yield a.next()).done;l=!1){let x=h.value;o&&o!==x.id&&this._addChatCompletion(u(this,G,"m",rn).call(this)),u(this,G,"m",us).call(this,x),o=x.id}}catch{m=[h]}finally{try{l&&(h=a.return)&&(yield h.call(a))}finally{if(m)throw m[0]}}if(s.controller.signal?.aborted)throw new V;return this._addChatCompletion(u(this,G,"m",rn).call(this))})}[(ke=new WeakMap,It=new WeakMap,Ue=new WeakMap,G=new WeakSet,cs=function(){this.ended||P(this,Ue,void 0,"f")},tn=function(t){let r=u(this,It,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},u(this,It,"f")[t.index]=r,r)},us=function(t){if(this.ended)return;let r=u(this,G,"m",Wo).call(this,t);this._emit("chunk",t,r);for(let s of t.choices){let o=r.choices[s.index];s.delta.content!=null&&o.message?.role==="assistant"&&o.message?.content&&(this._emit("content",s.delta.content,o.message.content),this._emit("content.delta",{delta:s.delta.content,snapshot:o.message.content,parsed:o.message.parsed})),s.delta.refusal!=null&&o.message?.role==="assistant"&&o.message?.refusal&&this._emit("refusal.delta",{delta:s.delta.refusal,snapshot:o.message.refusal}),s.logprobs?.content!=null&&o.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:s.logprobs?.content,snapshot:o.logprobs?.content??[]}),s.logprobs?.refusal!=null&&o.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:s.logprobs?.refusal,snapshot:o.logprobs?.refusal??[]});let a=u(this,G,"m",tn).call(this,o);o.finish_reason&&(u(this,G,"m",fs).call(this,o),a.current_tool_call_index!=null&&u(this,G,"m",ds).call(this,o,a.current_tool_call_index));for(let l of s.delta.tool_calls??[])a.current_tool_call_index!==l.index&&(u(this,G,"m",fs).call(this,o),a.current_tool_call_index!=null&&u(this,G,"m",ds).call(this,o,a.current_tool_call_index)),a.current_tool_call_index=l.index;for(let l of s.delta.tool_calls??[]){let h=o.message.tool_calls?.[l.index];h?.type&&(h?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:h.function?.name,index:l.index,arguments:h.function.arguments,parsed_arguments:h.function.parsed_arguments,arguments_delta:l.function?.arguments??""}):(h?.type,void 0))}}},ds=function(t,r){if(u(this,G,"m",tn).call(this,t).done_tool_calls.has(r))return;let o=t.message.tool_calls?.[r];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if(o.type==="function"){let a=u(this,ke,"f")?.tools?.find(l=>ur(l)&&l.function.name===o.function.name);this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:r,arguments:o.function.arguments,parsed_arguments:He(a)?a.$parseRaw(o.function.arguments):a?.function.strict?JSON.parse(o.function.arguments):null})}else o.type},fs=function(t){let r=u(this,G,"m",tn).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;let s=u(this,G,"m",ms).call(this);this._emit("content.done",{content:t.message.content,parsed:s?s.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},rn=function(){if(this.ended)throw new I("stream has ended, this shouldn't happen");let t=u(this,Ue,"f");if(!t)throw new I("request ended without sending any chunks");return P(this,Ue,void 0,"f"),P(this,It,[],"f"),Hi(t,u(this,ke,"f"))},ms=function(){let t=u(this,ke,"f")?.response_format;return dr(t)?t:null},Wo=function(t){var r,s,o,a;let l=u(this,Ue,"f"),x=t,{choices:h}=x,m=O(x,["choices"]);l?Object.assign(l,m):l=P(this,Ue,c(i({},m),{choices:[]}),"f");for(let B of t.choices){let T=B,{delta:k,finish_reason:A,index:F,logprobs:j=null}=T,D=O(T,["delta","finish_reason","index","logprobs"]);let v=l.choices[F];if(v||(v=l.choices[F]=i({finish_reason:A,index:F,message:{},logprobs:j},D)),j)if(!v.logprobs)v.logprobs=Object.assign({},j);else{let g=j,{content:N,refusal:ee}=g,te=O(g,["content","refusal"]);Object.assign(v.logprobs,te),N&&((r=v.logprobs).content??(r.content=[]),v.logprobs.content.push(...N)),ee&&((s=v.logprobs).refusal??(s.refusal=[]),v.logprobs.refusal.push(...ee))}if(A&&(v.finish_reason=A,u(this,ke,"f")&&Zn(u(this,ke,"f")))){if(A==="length")throw new pt;if(A==="content_filter")throw new ht}if(Object.assign(v,D),!k)continue;let _=k,{content:L,refusal:$,function_call:S,role:R,tool_calls:q}=_,Y=O(_,["content","refusal","function_call","role","tool_calls"]);if(Object.assign(v.message,Y),$&&(v.message.refusal=(v.message.refusal||"")+$),R&&(v.message.role=R),S&&(v.message.function_call?(S.name&&(v.message.function_call.name=S.name),S.arguments&&((o=v.message.function_call).arguments??(o.arguments=""),v.message.function_call.arguments+=S.arguments)):v.message.function_call=S),L&&(v.message.content=(v.message.content||"")+L,!v.message.refusal&&u(this,G,"m",ms).call(this)&&(v.message.parsed=ls(v.message.content))),q){v.message.tool_calls||(v.message.tool_calls=[]);for(let b of q){let w=b,{index:N,id:ee,type:te,function:Ce}=w,Fr=O(w,["index","id","type","function"]);let ge=(a=v.message.tool_calls)[N]??(a[N]={});Object.assign(ge,Fr),ee&&(ge.id=ee),te&&(ge.type=te),Ce&&(ge.function??(ge.function={name:Ce.name??"",arguments:""})),Ce?.name&&(ge.function.name=Ce.name),Ce?.arguments&&(ge.function.arguments+=Ce.arguments,Lo(u(this,ke,"f"),ge)&&(ge.function.parsed_arguments=ls(ge.function.arguments)))}}}return l},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("chunk",s=>{let o=t.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(let s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(let o of t)o.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(let o of t)o.reject(s);t.length=0}),{next:()=>d(this,null,function*(){return e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,a)=>t.push({resolve:o,reject:a})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0})}),return:()=>d(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}toReadableStream(){return new Ie(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}};function Hi(n,e){let m=n,{id:t,choices:r,created:s,model:o,system_fingerprint:a}=m,l=O(m,["id","choices","created","model","system_fingerprint"]),h=i(c(i({},l),{id:t,choices:r.map(B=>{var T=B,{message:x,finish_reason:g,index:_,logprobs:b}=T,w=O(T,["message","finish_reason","index","logprobs"]);if(!g)throw new I(`missing finish_reason for choice ${_}`);let v=x,{content:k=null,function_call:A,tool_calls:F}=v,j=O(v,["content","function_call","tool_calls"]),D=x.role;if(!D)throw new I(`missing role for choice ${_}`);if(A){let{arguments:L,name:$}=A;if(L==null)throw new I(`missing function_call.arguments for choice ${_}`);if(!$)throw new I(`missing function_call.name for choice ${_}`);return c(i({},w),{message:{content:k,function_call:{arguments:L,name:$},role:D,refusal:x.refusal??null},finish_reason:g,index:_,logprobs:b})}return F?c(i({},w),{index:_,finish_reason:g,logprobs:b,message:c(i({},j),{role:D,content:k,refusal:x.refusal??null,tool_calls:F.map((L,$)=>{let Ce=L,{function:S,type:R,id:q}=Ce,Y=O(Ce,["function","type","id"]),Fr=S||{},{arguments:N,name:ee}=Fr,te=O(Fr,["arguments","name"]);if(q==null)throw new I(`missing choices[${_}].tool_calls[${$}].id
${nn(n)}`);if(R==null)throw new I(`missing choices[${_}].tool_calls[${$}].type
${nn(n)}`);if(ee==null)throw new I(`missing choices[${_}].tool_calls[${$}].function.name
${nn(n)}`);if(N==null)throw new I(`missing choices[${_}].tool_calls[${$}].function.arguments
${nn(n)}`);return c(i({},Y),{id:q,type:R,function:c(i({},te),{name:ee,arguments:N})})})})}):c(i({},w),{message:c(i({},j),{content:k,role:D,refusal:x.refusal??null}),finish_reason:g,index:_,logprobs:b})}),created:s,model:o,object:"chat.completion"}),a?{system_fingerprint:a}:{});return Fo(h,e)}function nn(n){return JSON.stringify(n)}var br=class n extends Ve{static fromReadableStream(e){let t=new n(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,r){let s=new n(t),o=c(i({},r),{headers:c(i({},r?.headers),{"X-Stainless-Helper-Method":"runTools"})});return s._run(()=>s._runTools(e,t,o)),s}};var Te=class extends p{constructor(){super(...arguments),this.messages=new We(this._client)}create(e,t){return this._client.post("/chat/completions",c(i({body:e},t),{stream:e.stream??!1}))}retrieve(e,t){return this._client.get(f`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(f`/chat/completions/${e}`,i({body:t},r))}list(e={},t){return this._client.getAPIList("/chat/completions",E,i({query:e},t))}delete(e,t){return this._client.delete(f`/chat/completions/${e}`,t)}parse(e,t){return Uo(e.tools),this._client.chat.completions.create(e,c(i({},t),{headers:c(i({},t?.headers),{"X-Stainless-Helper-Method":"chat.completions.parse"})}))._thenUnwrap(r=>fr(r,e))}runTools(e,t){return e.stream?br.runTools(this._client,e,t):_r.runTools(this._client,e,t)}stream(e,t){return Ve.createChatCompletion(this._client,e,t)}};Te.Messages=We;var yr=(()=>{class n extends p{constructor(){super(...arguments),this.completions=new Te(this._client)}}return n.Completions=Te,n})();var Ho=Symbol("brand.privateNullableHeaders");function*Ji(n){if(!n)return;if(Ho in n){let{values:r,nulls:s}=n;yield*bs(r.entries());for(let o of s)yield[o,null];return}let e=!1,t;n instanceof Headers?t=n.entries():Mn(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let r of t){let s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");let o=Mn(r[1])?r[1]:[r[1]],a=!1;for(let l of o)l!==void 0&&(e&&!a&&(a=!0,yield[s,null]),yield[s,l])}}var y=n=>{let e=new Headers,t=new Set;for(let r of n){let s=new Set;for(let[o,a]of Ji(r)){let l=o.toLowerCase();s.has(l)||(e.delete(o),s.add(l)),a===null?(e.delete(o),t.add(l)):(e.append(o,a),t.delete(l))}}return{[Ho]:!0,values:e,nulls:t}};var At=class extends p{create(e,t){return this._client.post("/audio/speech",c(i({body:e},t),{headers:y([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0}))}};var Pt=class extends p{create(e,t){return this._client.post("/audio/transcriptions",ce(c(i({body:e},t),{stream:e.stream??!1,__metadata:{model:e.model}}),this._client))}};var Ct=class extends p{create(e,t){return this._client.post("/audio/translations",ce(c(i({body:e},t),{__metadata:{model:e.model}}),this._client))}};var wr=(()=>{class n extends p{constructor(){super(...arguments),this.transcriptions=new Pt(this._client),this.translations=new Ct(this._client),this.speech=new At(this._client)}}return n.Transcriptions=Pt,n.Translations=Ct,n.Speech=At,n})();var Je=class extends p{create(e,t){return this._client.post("/batches",i({body:e},t))}retrieve(e,t){return this._client.get(f`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",E,i({query:e},t))}cancel(e,t){return this._client.post(f`/batches/${e}/cancel`,t)}};var vt=class extends p{create(e,t){return this._client.post("/assistants",c(i({body:e},t),{headers:y([{"OpenAI-Beta":"assistants=v2"},t?.headers])}))}retrieve(e,t){return this._client.get(f`/assistants/${e}`,c(i({},t),{headers:y([{"OpenAI-Beta":"assistants=v2"},t?.headers])}))}update(e,t,r){return this._client.post(f`/assistants/${e}`,c(i({body:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}list(e={},t){return this._client.getAPIList("/assistants",E,c(i({query:e},t),{headers:y([{"OpenAI-Beta":"assistants=v2"},t?.headers])}))}delete(e,t){return this._client.delete(f`/assistants/${e}`,c(i({},t),{headers:y([{"OpenAI-Beta":"assistants=v2"},t?.headers])}))}};var Et=class extends p{create(e,t){return this._client.post("/realtime/sessions",c(i({body:e},t),{headers:y([{"OpenAI-Beta":"assistants=v2"},t?.headers])}))}};var St=class extends p{create(e,t){return this._client.post("/realtime/transcription_sessions",c(i({body:e},t),{headers:y([{"OpenAI-Beta":"assistants=v2"},t?.headers])}))}};var sn=(()=>{class n extends p{constructor(){super(...arguments),this.sessions=new Et(this._client),this.transcriptionSessions=new St(this._client)}}return n.Sessions=Et,n.TranscriptionSessions=St,n})();var Rt=class extends p{create(e,t){return this._client.post("/chatkit/sessions",c(i({body:e},t),{headers:y([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])}))}cancel(e,t){return this._client.post(f`/chatkit/sessions/${e}/cancel`,c(i({},t),{headers:y([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])}))}};var Ot=class extends p{retrieve(e,t){return this._client.get(f`/chatkit/threads/${e}`,c(i({},t),{headers:y([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])}))}list(e={},t){return this._client.getAPIList("/chatkit/threads",Re,c(i({query:e},t),{headers:y([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])}))}delete(e,t){return this._client.delete(f`/chatkit/threads/${e}`,c(i({},t),{headers:y([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])}))}listItems(e,t={},r){return this._client.getAPIList(f`/chatkit/threads/${e}/items`,Re,c(i({query:t},r),{headers:y([{"OpenAI-Beta":"chatkit_beta=v1"},r?.headers])}))}};var on=(()=>{class n extends p{constructor(){super(...arguments),this.sessions=new Rt(this._client),this.threads=new Ot(this._client)}}return n.Sessions=Rt,n.Threads=Ot,n})();var kt=class extends p{create(e,t,r){return this._client.post(f`/threads/${e}/messages`,c(i({body:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}retrieve(e,t,r){let{thread_id:s}=t;return this._client.get(f`/threads/${s}/messages/${e}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}update(e,t,r){let a=t,{thread_id:s}=a,o=O(a,["thread_id"]);return this._client.post(f`/threads/${s}/messages/${e}`,c(i({body:o},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}list(e,t={},r){return this._client.getAPIList(f`/threads/${e}/messages`,E,c(i({query:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}delete(e,t,r){let{thread_id:s}=t;return this._client.delete(f`/threads/${s}/messages/${e}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}};var Tt=class extends p{retrieve(e,t,r){let l=t,{thread_id:s,run_id:o}=l,a=O(l,["thread_id","run_id"]);return this._client.get(f`/threads/${s}/runs/${o}/steps/${e}`,c(i({query:a},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}list(e,t,r){let a=t,{thread_id:s}=a,o=O(a,["thread_id"]);return this._client.getAPIList(f`/threads/${s}/runs/${e}/steps`,E,c(i({query:o},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}};var Vo=n=>{if(typeof Buffer<"u"){let e=Buffer.from(n,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{let e=atob(n),t=e.length,r=new Uint8Array(t);for(let s=0;s<t;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};var pe=n=>{if(typeof globalThis.process<"u")return globalThis.process.env?.[n]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(n)?.trim()};var Q,Ge,ps,Pe,an,he,Xe,$t,Ke,un,ue,ln,cn,Ar,xr,Ir,Jo,Ko,Go,Xo,zo,Qo,Yo,$e=class extends Ne{constructor(){super(...arguments),Q.add(this),ps.set(this,[]),Pe.set(this,{}),an.set(this,{}),he.set(this,void 0),Xe.set(this,void 0),$t.set(this,void 0),Ke.set(this,void 0),un.set(this,void 0),ue.set(this,void 0),ln.set(this,void 0),cn.set(this,void 0),Ar.set(this,void 0)}[(ps=new WeakMap,Pe=new WeakMap,an=new WeakMap,he=new WeakMap,Xe=new WeakMap,$t=new WeakMap,Ke=new WeakMap,un=new WeakMap,ue=new WeakMap,ln=new WeakMap,cn=new WeakMap,Ar=new WeakMap,Q=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",s=>{let o=t.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(let s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(let o of t)o.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(let o of t)o.reject(s);t.length=0}),{next:()=>d(this,null,function*(){return e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,a)=>t.push({resolve:o,reject:a})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0})}),return:()=>d(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}static fromReadableStream(e){let t=new Ge;return t._run(()=>t._fromReadableStream(e)),t}_fromReadableStream(e,t){return d(this,null,function*(){let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();let s=Ie.fromReadableStream(e,this.controller);try{for(var o=W(s),a,l,h;a=!(l=yield o.next()).done;a=!1){let m=l.value;u(this,Q,"m",xr).call(this,m)}}catch{h=[l]}finally{try{a&&(l=o.return)&&(yield l.call(o))}finally{if(h)throw h[0]}}if(s.controller.signal?.aborted)throw new V;return this._addRun(u(this,Q,"m",Ir).call(this))})}toReadableStream(){return new Ie(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s){let o=new Ge;return o._run(()=>o._runToolAssistantStream(e,t,r,c(i({},s),{headers:c(i({},s?.headers),{"X-Stainless-Helper-Method":"stream"})}))),o}_createToolAssistantStream(e,t,r,s){return d(this,null,function*(){let o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));let a=c(i({},r),{stream:!0}),l=yield e.submitToolOutputs(t,a,c(i({},s),{signal:this.controller.signal}));this._connected();try{for(var h=W(l),m,x,g;m=!(x=yield h.next()).done;m=!1){let _=x.value;u(this,Q,"m",xr).call(this,_)}}catch{g=[x]}finally{try{m&&(x=h.return)&&(yield x.call(h))}finally{if(g)throw g[0]}}if(l.controller.signal?.aborted)throw new V;return this._addRun(u(this,Q,"m",Ir).call(this))})}static createThreadAssistantStream(e,t,r){let s=new Ge;return s._run(()=>s._threadAssistantStream(e,t,c(i({},r),{headers:c(i({},r?.headers),{"X-Stainless-Helper-Method":"stream"})}))),s}static createAssistantStream(e,t,r,s){let o=new Ge;return o._run(()=>o._runAssistantStream(e,t,r,c(i({},s),{headers:c(i({},s?.headers),{"X-Stainless-Helper-Method":"stream"})}))),o}currentEvent(){return u(this,ln,"f")}currentRun(){return u(this,cn,"f")}currentMessageSnapshot(){return u(this,he,"f")}currentRunStepSnapshot(){return u(this,Ar,"f")}finalRunSteps(){return d(this,null,function*(){return yield this.done(),Object.values(u(this,Pe,"f"))})}finalMessages(){return d(this,null,function*(){return yield this.done(),Object.values(u(this,an,"f"))})}finalRun(){return d(this,null,function*(){if(yield this.done(),!u(this,Xe,"f"))throw Error("Final run was not received.");return u(this,Xe,"f")})}_createThreadAssistantStream(e,t,r){return d(this,null,function*(){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let o=c(i({},t),{stream:!0}),a=yield e.createAndRun(o,c(i({},r),{signal:this.controller.signal}));this._connected();try{for(var l=W(a),h,m,x;h=!(m=yield l.next()).done;h=!1){let g=m.value;u(this,Q,"m",xr).call(this,g)}}catch{x=[m]}finally{try{h&&(m=l.return)&&(yield m.call(l))}finally{if(x)throw x[0]}}if(a.controller.signal?.aborted)throw new V;return this._addRun(u(this,Q,"m",Ir).call(this))})}_createAssistantStream(e,t,r,s){return d(this,null,function*(){let o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));let a=c(i({},r),{stream:!0}),l=yield e.create(t,a,c(i({},s),{signal:this.controller.signal}));this._connected();try{for(var h=W(l),m,x,g;m=!(x=yield h.next()).done;m=!1){let _=x.value;u(this,Q,"m",xr).call(this,_)}}catch{g=[x]}finally{try{m&&(x=h.return)&&(yield x.call(h))}finally{if(g)throw g[0]}}if(l.controller.signal?.aborted)throw new V;return this._addRun(u(this,Q,"m",Ir).call(this))})}static accumulateDelta(e,t){for(let[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let o=e[r];if(o==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof o=="string"&&typeof s=="string")o+=s;else if(typeof o=="number"&&typeof s=="number")o+=s;else if(gt(o)&&gt(s))o=this.accumulateDelta(o,s);else if(Array.isArray(o)&&Array.isArray(s)){if(o.every(a=>typeof a=="string"||typeof a=="number")){o.push(...s);continue}for(let a of s){if(!gt(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);let l=a.index;if(l==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);let h=o[l];h==null?o.push(a):o[l]=this.accumulateDelta(h,a)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${o}`);e[r]=o}return e}_addRun(e){return e}_threadAssistantStream(e,t,r){return d(this,null,function*(){return yield this._createThreadAssistantStream(t,e,r)})}_runAssistantStream(e,t,r,s){return d(this,null,function*(){return yield this._createAssistantStream(t,e,r,s)})}_runToolAssistantStream(e,t,r,s){return d(this,null,function*(){return yield this._createToolAssistantStream(t,e,r,s)})}};Ge=$e,xr=function(e){if(!this.ended)switch(P(this,ln,e,"f"),u(this,Q,"m",Go).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":u(this,Q,"m",Yo).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":u(this,Q,"m",Ko).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":u(this,Q,"m",Jo).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier");default:}},Ir=function(){if(this.ended)throw new I("stream has ended, this shouldn't happen");if(!u(this,Xe,"f"))throw Error("Final run has not been received");return u(this,Xe,"f")},Jo=function(e){let[t,r]=u(this,Q,"m",zo).call(this,e,u(this,he,"f"));P(this,he,t,"f"),u(this,an,"f")[t.id]=t;for(let s of r){let o=t.content[s.index];o?.type=="text"&&this._emit("textCreated",o.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let s of e.data.delta.content){if(s.type=="text"&&s.text){let o=s.text,a=t.content[s.index];if(a&&a.type=="text")this._emit("textDelta",o,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=u(this,$t,"f")){if(u(this,Ke,"f"))switch(u(this,Ke,"f").type){case"text":this._emit("textDone",u(this,Ke,"f").text,u(this,he,"f"));break;case"image_file":this._emit("imageFileDone",u(this,Ke,"f").image_file,u(this,he,"f"));break}P(this,$t,s.index,"f")}P(this,Ke,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(u(this,$t,"f")!==void 0){let s=e.data.content[u(this,$t,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,u(this,he,"f"));break;case"text":this._emit("textDone",s.text,u(this,he,"f"));break}}u(this,he,"f")&&this._emit("messageDone",e.data),P(this,he,void 0,"f")}},Ko=function(e){let t=u(this,Q,"m",Xo).call(this,e);switch(P(this,Ar,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(let o of r.step_details.tool_calls)o.index==u(this,un,"f")?this._emit("toolCallDelta",o,t.step_details.tool_calls[o.index]):(u(this,ue,"f")&&this._emit("toolCallDone",u(this,ue,"f")),P(this,un,o.index,"f"),P(this,ue,t.step_details.tool_calls[o.index],"f"),u(this,ue,"f")&&this._emit("toolCallCreated",u(this,ue,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":P(this,Ar,void 0,"f"),e.data.step_details.type=="tool_calls"&&u(this,ue,"f")&&(this._emit("toolCallDone",u(this,ue,"f")),P(this,ue,void 0,"f")),this._emit("runStepDone",e.data,t);break;case"thread.run.step.in_progress":break}},Go=function(e){u(this,ps,"f").push(e),this._emit("event",e)},Xo=function(e){switch(e.event){case"thread.run.step.created":return u(this,Pe,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=u(this,Pe,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){let s=Ge.accumulateDelta(t,r.delta);u(this,Pe,"f")[e.data.id]=s}return u(this,Pe,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":u(this,Pe,"f")[e.data.id]=e.data;break}if(u(this,Pe,"f")[e.data.id])return u(this,Pe,"f")[e.data.id];throw new Error("No snapshot available")},zo=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(let o of s.delta.content)if(o.index in t.content){let a=t.content[o.index];t.content[o.index]=u(this,Q,"m",Qo).call(this,o,a)}else t.content[o.index]=o,r.push(o);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Qo=function(e,t){return Ge.accumulateDelta(t,e)},Yo=function(e){switch(P(this,cn,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":P(this,Xe,e.data,"f"),u(this,ue,"f")&&(this._emit("toolCallDone",u(this,ue,"f")),P(this,ue,void 0,"f"));break;case"thread.run.cancelling":break}};var dn=(()=>{class n extends p{constructor(){super(...arguments),this.steps=new Tt(this._client)}create(t,r,s){let l=r,{include:o}=l,a=O(l,["include"]);return this._client.post(f`/threads/${t}/runs`,c(i({query:{include:o},body:a},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:r.stream??!1}))}retrieve(t,r,s){let{thread_id:o}=r;return this._client.get(f`/threads/${o}/runs/${t}`,c(i({},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers])}))}update(t,r,s){let l=r,{thread_id:o}=l,a=O(l,["thread_id"]);return this._client.post(f`/threads/${o}/runs/${t}`,c(i({body:a},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers])}))}list(t,r={},s){return this._client.getAPIList(f`/threads/${t}/runs`,E,c(i({query:r},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers])}))}cancel(t,r,s){let{thread_id:o}=r;return this._client.post(f`/threads/${o}/runs/${t}/cancel`,c(i({},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers])}))}createAndPoll(t,r,s){return d(this,null,function*(){let o=yield this.create(t,r,s);return yield this.poll(o.id,{thread_id:t},s)})}createAndStream(t,r,s){return $e.createAssistantStream(t,this._client.beta.threads.runs,r,s)}poll(t,r,s){return d(this,null,function*(){let o=y([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:a,response:l}=yield this.retrieve(t,r,c(i({},s),{headers:i(i({},s?.headers),o)})).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let h=5e3;if(s?.pollIntervalMs)h=s.pollIntervalMs;else{let m=l.headers.get("openai-poll-after-ms");if(m){let x=parseInt(m);isNaN(x)||(h=x)}}yield we(h);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}})}stream(t,r,s){return $e.createAssistantStream(t,this._client.beta.threads.runs,r,s)}submitToolOutputs(t,r,s){let l=r,{thread_id:o}=l,a=O(l,["thread_id"]);return this._client.post(f`/threads/${o}/runs/${t}/submit_tool_outputs`,c(i({body:a},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:r.stream??!1}))}submitToolOutputsAndPoll(t,r,s){return d(this,null,function*(){let o=yield this.submitToolOutputs(t,r,s);return yield this.poll(o.id,r,s)})}submitToolOutputsStream(t,r,s){return $e.createToolAssistantStream(t,this._client.beta.threads.runs,r,s)}}return n.Steps=Tt,n})();var fn=(()=>{class n extends p{constructor(){super(...arguments),this.runs=new dn(this._client),this.messages=new kt(this._client)}create(t={},r){return this._client.post("/threads",c(i({body:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}retrieve(t,r){return this._client.get(f`/threads/${t}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}update(t,r,s){return this._client.post(f`/threads/${t}`,c(i({body:r},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers])}))}delete(t,r){return this._client.delete(f`/threads/${t}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}createAndRun(t,r){return this._client.post("/threads/runs",c(i({body:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:t.stream??!1}))}createAndRunPoll(t,r){return d(this,null,function*(){let s=yield this.createAndRun(t,r);return yield this.runs.poll(s.id,{thread_id:s.thread_id},r)})}createAndRunStream(t,r){return $e.createThreadAssistantStream(t,this._client.beta.threads,r)}}return n.Runs=dn,n.Messages=kt,n})();var Pr=(()=>{class n extends p{constructor(){super(...arguments),this.realtime=new sn(this._client),this.chatkit=new on(this._client),this.assistants=new vt(this._client),this.threads=new fn(this._client)}}return n.Realtime=sn,n.ChatKit=on,n.Assistants=vt,n.Threads=fn,n})();var ze=class extends p{create(e,t){return this._client.post("/completions",c(i({body:e},t),{stream:e.stream??!1}))}};var Mt=class extends p{retrieve(e,t,r){let{container_id:s}=t;return this._client.get(f`/containers/${s}/files/${e}/content`,c(i({},r),{headers:y([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0}))}};var mn=(()=>{class n extends p{constructor(){super(...arguments),this.content=new Mt(this._client)}create(t,r,s){return this._client.post(f`/containers/${t}/files`,ce(i({body:r},s),this._client))}retrieve(t,r,s){let{container_id:o}=r;return this._client.get(f`/containers/${o}/files/${t}`,s)}list(t,r={},s){return this._client.getAPIList(f`/containers/${t}/files`,E,i({query:r},s))}delete(t,r,s){let{container_id:o}=r;return this._client.delete(f`/containers/${o}/files/${t}`,c(i({},s),{headers:y([{Accept:"*/*"},s?.headers])}))}}return n.Content=Mt,n})();var Cr=(()=>{class n extends p{constructor(){super(...arguments),this.files=new mn(this._client)}create(t,r){return this._client.post("/containers",i({body:t},r))}retrieve(t,r){return this._client.get(f`/containers/${t}`,r)}list(t={},r){return this._client.getAPIList("/containers",E,i({query:t},r))}delete(t,r){return this._client.delete(f`/containers/${t}`,c(i({},r),{headers:y([{Accept:"*/*"},r?.headers])}))}}return n.Files=mn,n})();var Ft=class extends p{create(e,t,r){let a=t,{include:s}=a,o=O(a,["include"]);return this._client.post(f`/conversations/${e}/items`,i({query:{include:s},body:o},r))}retrieve(e,t,r){let a=t,{conversation_id:s}=a,o=O(a,["conversation_id"]);return this._client.get(f`/conversations/${s}/items/${e}`,i({query:o},r))}list(e,t={},r){return this._client.getAPIList(f`/conversations/${e}/items`,Re,i({query:t},r))}delete(e,t,r){let{conversation_id:s}=t;return this._client.delete(f`/conversations/${s}/items/${e}`,r)}};var vr=(()=>{class n extends p{constructor(){super(...arguments),this.items=new Ft(this._client)}create(t={},r){return this._client.post("/conversations",i({body:t},r))}retrieve(t,r){return this._client.get(f`/conversations/${t}`,r)}update(t,r,s){return this._client.post(f`/conversations/${t}`,i({body:r},s))}delete(t,r){return this._client.delete(f`/conversations/${t}`,r)}}return n.Items=Ft,n})();var Qe=class extends p{create(e,t){let r=!!e.encoding_format,s=r?e.encoding_format:"base64";r&&H(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let o=this._client.post("/embeddings",i({body:c(i({},e),{encoding_format:s})},t));return r?o:(H(this._client).debug("embeddings/decoding base64 embeddings from base64"),o._thenUnwrap(a=>(a&&a.data&&a.data.forEach(l=>{let h=l.embedding;l.embedding=Vo(h)}),a)))}};var Lt=class extends p{retrieve(e,t,r){let{eval_id:s,run_id:o}=t;return this._client.get(f`/evals/${s}/runs/${o}/output_items/${e}`,r)}list(e,t,r){let a=t,{eval_id:s}=a,o=O(a,["eval_id"]);return this._client.getAPIList(f`/evals/${s}/runs/${e}/output_items`,E,i({query:o},r))}};var pn=(()=>{class n extends p{constructor(){super(...arguments),this.outputItems=new Lt(this._client)}create(t,r,s){return this._client.post(f`/evals/${t}/runs`,i({body:r},s))}retrieve(t,r,s){let{eval_id:o}=r;return this._client.get(f`/evals/${o}/runs/${t}`,s)}list(t,r={},s){return this._client.getAPIList(f`/evals/${t}/runs`,E,i({query:r},s))}delete(t,r,s){let{eval_id:o}=r;return this._client.delete(f`/evals/${o}/runs/${t}`,s)}cancel(t,r,s){let{eval_id:o}=r;return this._client.post(f`/evals/${o}/runs/${t}`,s)}}return n.OutputItems=Lt,n})();var Er=(()=>{class n extends p{constructor(){super(...arguments),this.runs=new pn(this._client)}create(t,r){return this._client.post("/evals",i({body:t},r))}retrieve(t,r){return this._client.get(f`/evals/${t}`,r)}update(t,r,s){return this._client.post(f`/evals/${t}`,i({body:r},s))}list(t={},r){return this._client.getAPIList("/evals",E,i({query:t},r))}delete(t,r){return this._client.delete(f`/evals/${t}`,r)}}return n.Runs=pn,n})();var Ye=class extends p{create(e,t){return this._client.post("/files",ce(i({body:e},t),this._client))}retrieve(e,t){return this._client.get(f`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",E,i({query:e},t))}delete(e,t){return this._client.delete(f`/files/${e}`,t)}content(e,t){return this._client.get(f`/files/${e}/content`,c(i({},t),{headers:y([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0}))}waitForProcessing(s){return d(this,arguments,function*(e,{pollInterval:t=5e3,maxWait:r=1800*1e3}={}){let o=new Set(["processed","error","deleted"]),a=Date.now(),l=yield this.retrieve(e);for(;!l.status||!o.has(l.status);)if(yield we(t),l=yield this.retrieve(e),Date.now()-a>r)throw new Fe({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return l})}};var Nt=class extends p{};var Ut=class extends p{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",i({body:e},t))}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",i({body:e},t))}};var hn=(()=>{class n extends p{constructor(){super(...arguments),this.graders=new Ut(this._client)}}return n.Graders=Ut,n})();var Bt=class extends p{create(e,t,r){return this._client.getAPIList(f`/fine_tuning/checkpoints/${e}/permissions`,Ae,i({body:t,method:"post"},r))}retrieve(e,t={},r){return this._client.get(f`/fine_tuning/checkpoints/${e}/permissions`,i({query:t},r))}delete(e,t,r){let{fine_tuned_model_checkpoint:s}=t;return this._client.delete(f`/fine_tuning/checkpoints/${s}/permissions/${e}`,r)}};var gn=(()=>{class n extends p{constructor(){super(...arguments),this.permissions=new Bt(this._client)}}return n.Permissions=Bt,n})();var jt=class extends p{list(e,t={},r){return this._client.getAPIList(f`/fine_tuning/jobs/${e}/checkpoints`,E,i({query:t},r))}};var _n=(()=>{class n extends p{constructor(){super(...arguments),this.checkpoints=new jt(this._client)}create(t,r){return this._client.post("/fine_tuning/jobs",i({body:t},r))}retrieve(t,r){return this._client.get(f`/fine_tuning/jobs/${t}`,r)}list(t={},r){return this._client.getAPIList("/fine_tuning/jobs",E,i({query:t},r))}cancel(t,r){return this._client.post(f`/fine_tuning/jobs/${t}/cancel`,r)}listEvents(t,r={},s){return this._client.getAPIList(f`/fine_tuning/jobs/${t}/events`,E,i({query:r},s))}pause(t,r){return this._client.post(f`/fine_tuning/jobs/${t}/pause`,r)}resume(t,r){return this._client.post(f`/fine_tuning/jobs/${t}/resume`,r)}}return n.Checkpoints=jt,n})();var Sr=(()=>{class n extends p{constructor(){super(...arguments),this.methods=new Nt(this._client),this.jobs=new _n(this._client),this.checkpoints=new gn(this._client),this.alpha=new hn(this._client)}}return n.Methods=Nt,n.Jobs=_n,n.Checkpoints=gn,n.Alpha=hn,n})();var Dt=class extends p{};var Rr=(()=>{class n extends p{constructor(){super(...arguments),this.graderModels=new Dt(this._client)}}return n.GraderModels=Dt,n})();var Ze=class extends p{createVariation(e,t){return this._client.post("/images/variations",ce(i({body:e},t),this._client))}edit(e,t){return this._client.post("/images/edits",ce(c(i({body:e},t),{stream:e.stream??!1}),this._client))}generate(e,t){return this._client.post("/images/generations",c(i({body:e},t),{stream:e.stream??!1}))}};var et=class extends p{retrieve(e,t){return this._client.get(f`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Ae,e)}delete(e,t){return this._client.delete(f`/models/${e}`,t)}};var tt=class extends p{create(e,t){return this._client.post("/moderations",i({body:e},t))}};var qt=class extends p{accept(e,t,r){return this._client.post(f`/realtime/calls/${e}/accept`,c(i({body:t},r),{headers:y([{Accept:"*/*"},r?.headers])}))}hangup(e,t){return this._client.post(f`/realtime/calls/${e}/hangup`,c(i({},t),{headers:y([{Accept:"*/*"},t?.headers])}))}refer(e,t,r){return this._client.post(f`/realtime/calls/${e}/refer`,c(i({body:t},r),{headers:y([{Accept:"*/*"},r?.headers])}))}reject(e,t={},r){return this._client.post(f`/realtime/calls/${e}/reject`,c(i({body:t},r),{headers:y([{Accept:"*/*"},r?.headers])}))}};var Wt=class extends p{create(e,t){return this._client.post("/realtime/client_secrets",i({body:e},t))}};var Or=(()=>{class n extends p{constructor(){super(...arguments),this.clientSecrets=new Wt(this._client),this.calls=new qt(this._client)}}return n.ClientSecrets=Wt,n.Calls=qt,n})();function Zo(n,e){return!e||!Aa(e)?c(i({},n),{output_parsed:null,output:n.output.map(t=>t.type==="function_call"?c(i({},t),{parsed_arguments:null}):t.type==="message"?c(i({},t),{content:t.content.map(r=>c(i({},r),{parsed:null}))}):t)}):hs(n,e)}function hs(n,e){let t=n.output.map(s=>{if(s.type==="function_call")return c(i({},s),{parsed_arguments:va(e,s)});if(s.type==="message"){let o=s.content.map(a=>a.type==="output_text"?c(i({},a),{parsed:Ia(e,a.text)}):a);return c(i({},s),{content:o})}return s}),r=Object.assign({},n,{output:t});return Object.getOwnPropertyDescriptor(n,"output_text")||bn(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(let s of r.output)if(s.type==="message"){for(let o of s.content)if(o.type==="output_text"&&o.parsed!==null)return o.parsed}return null}}),r}function Ia(n,e){return n.text?.format?.type!=="json_schema"?null:"$parseRaw"in n.text?.format?(n.text?.format).$parseRaw(e):JSON.parse(e)}function Aa(n){return!!dr(n.text?.format)}function Pa(n){return n?.$brand==="auto-parseable-tool"}function Ca(n,e){return n.find(t=>t.type==="function"&&t.name===e)}function va(n,e){let t=Ca(n.tools??[],e.name);return c(i(i({},e),e),{parsed_arguments:Pa(t)?t.$parseRaw(e.arguments):t?.strict?JSON.parse(e.arguments):null})}function bn(n){let e=[];for(let t of n.output)if(t.type==="message")for(let r of t.content)r.type==="output_text"&&e.push(r.text);n.output_text=e.join("")}var Ht,yn,Be,wn,ei,ti,ri,ni,xn=class n extends Ne{constructor(e){super(),Ht.add(this),yn.set(this,void 0),Be.set(this,void 0),wn.set(this,void 0),P(this,yn,e,"f")}static createResponse(e,t,r){let s=new n(t);return s._run(()=>s._createOrRetrieveResponse(e,t,c(i({},r),{headers:c(i({},r?.headers),{"X-Stainless-Helper-Method":"stream"})}))),s}_createOrRetrieveResponse(e,t,r){return d(this,null,function*(){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),u(this,Ht,"m",ei).call(this);let o,a=null;"response_id"in t?(o=yield e.responses.retrieve(t.response_id,{stream:!0},c(i({},r),{signal:this.controller.signal,stream:!0})),a=t.starting_after??null):o=yield e.responses.create(c(i({},t),{stream:!0}),c(i({},r),{signal:this.controller.signal})),this._connected();try{for(var l=W(o),h,m,x;h=!(m=yield l.next()).done;h=!1){let g=m.value;u(this,Ht,"m",ti).call(this,g,a)}}catch{x=[m]}finally{try{h&&(m=l.return)&&(yield m.call(l))}finally{if(x)throw x[0]}}if(o.controller.signal?.aborted)throw new V;return u(this,Ht,"m",ri).call(this)})}[(yn=new WeakMap,Be=new WeakMap,wn=new WeakMap,Ht=new WeakSet,ei=function(){this.ended||P(this,Be,void 0,"f")},ti=function(t,r){if(this.ended)return;let s=(a,l)=>{(r==null||l.sequence_number>r)&&this._emit(a,l)},o=u(this,Ht,"m",ni).call(this,t);switch(s("event",t),t.type){case"response.output_text.delta":{let a=o.output[t.output_index];if(!a)throw new I(`missing output at index ${t.output_index}`);if(a.type==="message"){let l=a.content[t.content_index];if(!l)throw new I(`missing content at index ${t.content_index}`);if(l.type!=="output_text")throw new I(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",c(i({},t),{snapshot:l.text}))}break}case"response.function_call_arguments.delta":{let a=o.output[t.output_index];if(!a)throw new I(`missing output at index ${t.output_index}`);a.type==="function_call"&&s("response.function_call_arguments.delta",c(i({},t),{snapshot:a.arguments}));break}default:s(t.type,t);break}},ri=function(){if(this.ended)throw new I("stream has ended, this shouldn't happen");let t=u(this,Be,"f");if(!t)throw new I("request ended without sending any events");P(this,Be,void 0,"f");let r=Ea(t,u(this,yn,"f"));return P(this,wn,r,"f"),r},ni=function(t){let r=u(this,Be,"f");if(!r){if(t.type!=="response.created")throw new I(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return r=P(this,Be,t.response,"f"),r}switch(t.type){case"response.output_item.added":{r.output.push(t.item);break}case"response.content_part.added":{let s=r.output[t.output_index];if(!s)throw new I(`missing output at index ${t.output_index}`);let o=s.type,a=t.part;o==="message"&&a.type!=="reasoning_text"?s.content.push(a):o==="reasoning"&&a.type==="reasoning_text"&&(s.content||(s.content=[]),s.content.push(a));break}case"response.output_text.delta":{let s=r.output[t.output_index];if(!s)throw new I(`missing output at index ${t.output_index}`);if(s.type==="message"){let o=s.content[t.content_index];if(!o)throw new I(`missing content at index ${t.content_index}`);if(o.type!=="output_text")throw new I(`expected content to be 'output_text', got ${o.type}`);o.text+=t.delta}break}case"response.function_call_arguments.delta":{let s=r.output[t.output_index];if(!s)throw new I(`missing output at index ${t.output_index}`);s.type==="function_call"&&(s.arguments+=t.delta);break}case"response.reasoning_text.delta":{let s=r.output[t.output_index];if(!s)throw new I(`missing output at index ${t.output_index}`);if(s.type==="reasoning"){let o=s.content?.[t.content_index];if(!o)throw new I(`missing content at index ${t.content_index}`);if(o.type!=="reasoning_text")throw new I(`expected content to be 'reasoning_text', got ${o.type}`);o.text+=t.delta}break}case"response.completed":{P(this,Be,t.response,"f");break}}return r},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",s=>{let o=t.shift();o?o.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(let s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(let o of t)o.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(let o of t)o.reject(s);t.length=0}),{next:()=>d(this,null,function*(){return e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,a)=>t.push({resolve:o,reject:a})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0})}),return:()=>d(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}finalResponse(){return d(this,null,function*(){yield this.done();let e=u(this,wn,"f");if(!e)throw new I("stream ended without producing a ChatCompletion");return e})}};function Ea(n,e){return Zo(n,e)}var Vt=class extends p{list(e,t={},r){return this._client.getAPIList(f`/responses/${e}/input_items`,E,i({query:t},r))}};var Jt=class extends p{count(e={},t){return this._client.post("/responses/input_tokens",i({body:e},t))}};var kr=(()=>{class n extends p{constructor(){super(...arguments),this.inputItems=new Vt(this._client),this.inputTokens=new Jt(this._client)}create(t,r){return this._client.post("/responses",c(i({body:t},r),{stream:t.stream??!1}))._thenUnwrap(s=>("object"in s&&s.object==="response"&&bn(s),s))}retrieve(t,r={},s){return this._client.get(f`/responses/${t}`,c(i({query:r},s),{stream:r?.stream??!1}))._thenUnwrap(o=>("object"in o&&o.object==="response"&&bn(o),o))}delete(t,r){return this._client.delete(f`/responses/${t}`,c(i({},r),{headers:y([{Accept:"*/*"},r?.headers])}))}parse(t,r){return this._client.responses.create(t,r)._thenUnwrap(s=>hs(s,t))}stream(t,r){return xn.createResponse(this._client,t,r)}cancel(t,r){return this._client.post(f`/responses/${t}/cancel`,r)}}return n.InputItems=Vt,n.InputTokens=Jt,n})();var Kt=class extends p{create(e,t,r){return this._client.post(f`/uploads/${e}/parts`,ce(i({body:t},r),this._client))}};var Tr=(()=>{class n extends p{constructor(){super(...arguments),this.parts=new Kt(this._client)}create(t,r){return this._client.post("/uploads",i({body:t},r))}cancel(t,r){return this._client.post(f`/uploads/${t}/cancel`,r)}complete(t,r,s){return this._client.post(f`/uploads/${t}/complete`,i({body:r},s))}}return n.Parts=Kt,n})();var si=n=>d(null,null,function*(){let e=yield Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(let s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}let r=[];for(let s of e)s.status==="fulfilled"&&r.push(s.value);return r});var Gt=class extends p{create(e,t,r){return this._client.post(f`/vector_stores/${e}/file_batches`,c(i({body:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}retrieve(e,t,r){let{vector_store_id:s}=t;return this._client.get(f`/vector_stores/${s}/file_batches/${e}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}cancel(e,t,r){let{vector_store_id:s}=t;return this._client.post(f`/vector_stores/${s}/file_batches/${e}/cancel`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}createAndPoll(e,t,r){return d(this,null,function*(){let s=yield this.create(e,t);return yield this.poll(e,s.id,r)})}listFiles(e,t,r){let a=t,{vector_store_id:s}=a,o=O(a,["vector_store_id"]);return this._client.getAPIList(f`/vector_stores/${s}/file_batches/${e}/files`,E,c(i({query:o},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}poll(e,t,r){return d(this,null,function*(){let s=y([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:o,response:a}=yield this.retrieve(t,{vector_store_id:e},c(i({},r),{headers:s})).withResponse();switch(o.status){case"in_progress":let l=5e3;if(r?.pollIntervalMs)l=r.pollIntervalMs;else{let h=a.headers.get("openai-poll-after-ms");if(h){let m=parseInt(h);isNaN(m)||(l=m)}}yield we(l);break;case"failed":case"cancelled":case"completed":return o}}})}uploadAndPoll(o,a,l){return d(this,arguments,function*(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let h=s?.maxConcurrency??5,m=Math.min(h,t.length),x=this._client,g=t.values(),_=[...r];function b(B){return d(this,null,function*(){for(let T of B){let k=yield x.files.create({file:T,purpose:"assistants"},s);_.push(k.id)}})}let w=Array(m).fill(g).map(b);return yield si(w),yield this.createAndPoll(e,{file_ids:_})})}};var Xt=class extends p{create(e,t,r){return this._client.post(f`/vector_stores/${e}/files`,c(i({body:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}retrieve(e,t,r){let{vector_store_id:s}=t;return this._client.get(f`/vector_stores/${s}/files/${e}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}update(e,t,r){let a=t,{vector_store_id:s}=a,o=O(a,["vector_store_id"]);return this._client.post(f`/vector_stores/${s}/files/${e}`,c(i({body:o},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}list(e,t={},r){return this._client.getAPIList(f`/vector_stores/${e}/files`,E,c(i({query:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}delete(e,t,r){let{vector_store_id:s}=t;return this._client.delete(f`/vector_stores/${s}/files/${e}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}createAndPoll(e,t,r){return d(this,null,function*(){let s=yield this.create(e,t,r);return yield this.poll(e,s.id,r)})}poll(e,t,r){return d(this,null,function*(){let s=y([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let o=yield this.retrieve(t,{vector_store_id:e},c(i({},r),{headers:s})).withResponse(),a=o.data;switch(a.status){case"in_progress":let l=5e3;if(r?.pollIntervalMs)l=r.pollIntervalMs;else{let h=o.response.headers.get("openai-poll-after-ms");if(h){let m=parseInt(h);isNaN(m)||(l=m)}}yield we(l);break;case"failed":case"completed":return a}}})}upload(e,t,r){return d(this,null,function*(){let s=yield this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)})}uploadAndPoll(e,t,r){return d(this,null,function*(){let s=yield this.upload(e,t,r);return yield this.poll(e,s.id,r)})}content(e,t,r){let{vector_store_id:s}=t;return this._client.getAPIList(f`/vector_stores/${s}/files/${e}/content`,Ae,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}};var $r=(()=>{class n extends p{constructor(){super(...arguments),this.files=new Xt(this._client),this.fileBatches=new Gt(this._client)}create(t,r){return this._client.post("/vector_stores",c(i({body:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}retrieve(t,r){return this._client.get(f`/vector_stores/${t}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}update(t,r,s){return this._client.post(f`/vector_stores/${t}`,c(i({body:r},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers])}))}list(t={},r){return this._client.getAPIList("/vector_stores",E,c(i({query:t},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}delete(t,r){return this._client.delete(f`/vector_stores/${t}`,c(i({},r),{headers:y([{"OpenAI-Beta":"assistants=v2"},r?.headers])}))}search(t,r,s){return this._client.getAPIList(f`/vector_stores/${t}/search`,Ae,c(i({body:r,method:"post"},s),{headers:y([{"OpenAI-Beta":"assistants=v2"},s?.headers])}))}}return n.Files=Xt,n.FileBatches=Gt,n})();var rt=class extends p{create(e,t){return this._client.post("/videos",Qn(i({body:e},t),this._client))}retrieve(e,t){return this._client.get(f`/videos/${e}`,t)}list(e={},t){return this._client.getAPIList("/videos",Re,i({query:e},t))}delete(e,t){return this._client.delete(f`/videos/${e}`,t)}downloadContent(e,t={},r){return this._client.get(f`/videos/${e}/content`,c(i({query:t},r),{headers:y([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0}))}remix(e,t,r){return this._client.post(f`/videos/${e}/remix`,Qn(i({body:t},r),this._client))}};var zt,oi,In,nt=class extends p{constructor(){super(...arguments),zt.add(this)}unwrap(o,a){return d(this,arguments,function*(e,t,r=this._client.webhookSecret,s=300){return yield this.verifySignature(e,t,r,s),JSON.parse(e)})}verifySignature(o,a){return d(this,arguments,function*(e,t,r=this._client.webhookSecret,s=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");u(this,zt,"m",oi).call(this,r);let l=y([t]).values,h=u(this,zt,"m",In).call(this,l,"webhook-signature"),m=u(this,zt,"m",In).call(this,l,"webhook-timestamp"),x=u(this,zt,"m",In).call(this,l,"webhook-id"),g=parseInt(m,10);if(isNaN(g))throw new ye("Invalid webhook timestamp format");let _=Math.floor(Date.now()/1e3);if(_-g>s)throw new ye("Webhook timestamp is too old");if(g>_+s)throw new ye("Webhook timestamp is too new");let b=h.split(" ").map(k=>k.startsWith("v1,")?k.substring(3):k),w=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),B=x?`${x}.${m}.${e}`:`${m}.${e}`,T=yield crypto.subtle.importKey("raw",w,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let k of b)try{let A=Buffer.from(k,"base64");if(yield crypto.subtle.verify("HMAC",T,A,new TextEncoder().encode(B)))return}catch{continue}throw new ye("The given webhook signature does not match the expected signature")})}};zt=new WeakSet,oi=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},In=function(e,t){if(!e)throw new Error("Headers are required");let r=e.get(t);if(r==null)throw new Error(`Missing required header: ${t}`);return r};var gs,_s,An,ii,C=class{constructor(l={}){var h=l,{baseURL:e=pe("OPENAI_BASE_URL"),apiKey:t=pe("OPENAI_API_KEY"),organization:r=pe("OPENAI_ORG_ID")??null,project:s=pe("OPENAI_PROJECT_ID")??null,webhookSecret:o=pe("OPENAI_WEBHOOK_SECRET")??null}=h,a=O(h,["baseURL","apiKey","organization","project","webhookSecret"]);if(gs.add(this),An.set(this,void 0),this.completions=new ze(this),this.chat=new yr(this),this.embeddings=new Qe(this),this.files=new Ye(this),this.images=new Ze(this),this.audio=new wr(this),this.moderations=new tt(this),this.models=new et(this),this.fineTuning=new Sr(this),this.graders=new Rr(this),this.vectorStores=new $r(this),this.webhooks=new nt(this),this.beta=new Pr(this),this.batches=new Je(this),this.uploads=new Tr(this),this.responses=new kr(this),this.realtime=new Or(this),this.conversations=new vr(this),this.evals=new Er(this),this.containers=new Cr(this),this.videos=new rt(this),t===void 0)throw new I("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");let m=c(i({apiKey:t,organization:r,project:s,webhookSecret:o},a),{baseURL:e||"https://api.openai.com/v1"});if(!m.dangerouslyAllowBrowser&&mo())throw new I(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=m.baseURL,this.timeout=m.timeout??_s.DEFAULT_TIMEOUT,this.logger=m.logger??console;let x="warn";this.logLevel=x,this.logLevel=Vn(m.logLevel,"ClientOptions.logLevel",this)??Vn(pe("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??x,this.fetchOptions=m.fetchOptions,this.maxRetries=m.maxRetries??2,this.fetch=m.fetch??ho(),P(this,An,_o,"f"),this._options=m,this.apiKey=typeof t=="string"?t:"Missing Key",this.organization=r,this.project=s,this.webhookSecret=o}withOptions(e){return new this.constructor(i(c(i({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret}),e))}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}authHeaders(e){return d(this,null,function*(){return y([{Authorization:`Bearer ${this.apiKey}`}])})}stringifyQuery(e){return Wn(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Le}`}defaultIdempotencyKey(){return`stainless-node-retry-${$n()}`}makeStatusError(e,t,r,s){return J.generate(e,t,r,s)}_callApiKey(){return d(this,null,function*(){let e=this._options.apiKey;if(typeof e!="function")return!1;let t;try{t=yield e()}catch(r){throw r instanceof I?r:new I(`Failed to get token from 'apiKey' function: ${r.message}`,{cause:r})}if(typeof t!="string"||!t)throw new I(`Expected 'apiKey' function argument to return a string but it returned ${t}`);return this.apiKey=t,!0})}buildURL(e,t,r){let s=!u(this,gs,"m",ii).call(this)&&r||this.baseURL,o=so(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return oo(a)||(t=i(i({},a),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}prepareOptions(e){return d(this,null,function*(){yield this._callApiKey()})}prepareRequest(s,o){return d(this,arguments,function*(e,{url:t,options:r}){})}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(s=>i({method:e,path:t},s)))}request(e,t=null){return new qe(this,this.makeRequest(e,t,void 0))}makeRequest(e,t,r){return d(this,null,function*(){let s=yield e,o=s.maxRetries??this.maxRetries;t==null&&(t=o),yield this.prepareOptions(s);let{req:a,url:l,timeout:h}=yield this.buildRequest(s,{retryCount:o-t});yield this.prepareRequest(a,{url:l,options:s});let m="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),x=r===void 0?"":`, retryOf: ${r}`,g=Date.now();if(H(this).debug(`[${m}] sending request`,Se({retryOfRequestLogID:r,method:s.method,url:l,options:s,headers:a.headers})),s.signal?.aborted)throw new V;let _=new AbortController,b=yield this.fetchWithTimeout(l,a,h,_).catch(nr),w=Date.now();if(b instanceof globalThis.Error){let k=`retrying, ${t} attempts remaining`;if(s.signal?.aborted)throw new V;let A=rr(b)||/timed? ?out/i.test(String(b)+("cause"in b?String(b.cause):""));if(t)return H(this).info(`[${m}] connection ${A?"timed out":"failed"} - ${k}`),H(this).debug(`[${m}] connection ${A?"timed out":"failed"} (${k})`,Se({retryOfRequestLogID:r,url:l,durationMs:w-g,message:b.message})),this.retryRequest(s,t,r??m);throw H(this).info(`[${m}] connection ${A?"timed out":"failed"} - error; no more retries left`),H(this).debug(`[${m}] connection ${A?"timed out":"failed"} (error; no more retries left)`,Se({retryOfRequestLogID:r,url:l,durationMs:w-g,message:b.message})),A?new Fe:new Me({cause:b})}let B=[...b.headers.entries()].filter(([k])=>k==="x-request-id").map(([k,A])=>", "+k+": "+JSON.stringify(A)).join(""),T=`[${m}${x}${B}] ${a.method} ${l} ${b.ok?"succeeded":"failed"} with status ${b.status} in ${w-g}ms`;if(!b.ok){let k=yield this.shouldRetry(b);if(t&&k){let L=`retrying, ${t} attempts remaining`;return yield go(b.body),H(this).info(`${T} - ${L}`),H(this).debug(`[${m}] response error (${L})`,Se({retryOfRequestLogID:r,url:b.url,status:b.status,headers:b.headers,durationMs:w-g})),this.retryRequest(s,t,r??m,b.headers)}let A=k?"error; no more retries left":"error; not retryable";H(this).info(`${T} - ${A}`);let F=yield b.text().catch(L=>nr(L).message),j=lo(F),D=j?void 0:F;throw H(this).debug(`[${m}] response error (${A})`,Se({retryOfRequestLogID:r,url:b.url,status:b.status,headers:b.headers,message:D,durationMs:Date.now()-g})),this.makeStatusError(b.status,j,D,b.headers)}return H(this).info(T),H(this).debug(`[${m}] response start`,Se({retryOfRequestLogID:r,url:b.url,status:b.status,headers:b.headers,durationMs:w-g})),{response:b,options:s,controller:_,requestLogID:m,retryOfRequestLogID:r,startTime:g}})}getAPIList(e,t,r){return this.requestAPIList(t,i({method:"get",path:e},r))}requestAPIList(e,t){let r=this.makeRequest(t,null,void 0);return new lr(this,r,e)}fetchWithTimeout(e,t,r,s){return d(this,null,function*(){let g=t||{},{signal:o,method:a}=g,l=O(g,["signal","method"]);o&&o.addEventListener("abort",()=>s.abort());let h=setTimeout(()=>s.abort(),r),m=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,x=i(c(i({signal:s.signal},m?{duplex:"half"}:{}),{method:"GET"}),l);a&&(x.method=a.toUpperCase());try{return yield this.fetch.call(void 0,e,x)}finally{clearTimeout(h)}})}shouldRetry(e){return d(this,null,function*(){let t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500})}retryRequest(e,t,r,s){return d(this,null,function*(){let o,a=s?.get("retry-after-ms");if(a){let h=parseFloat(a);Number.isNaN(h)||(o=h)}let l=s?.get("retry-after");if(l&&!o){let h=parseFloat(l);Number.isNaN(h)?o=Date.parse(l)-Date.now():o=h*1e3}if(!(o&&0<=o&&o<60*1e3)){let h=e.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(t,h)}return yield we(o),this.makeRequest(e,t-1,r)})}calculateDefaultRetryTimeoutMillis(e,t){let o=t-e,a=Math.min(.5*Math.pow(2,o),8),l=1-Math.random()*.25;return a*l*1e3}buildRequest(r){return d(this,arguments,function*(e,{retryCount:t=0}={}){let s=i({},e),{method:o,path:a,query:l,defaultBaseURL:h}=s,m=this.buildURL(a,l,h);"timeout"in s&&ao("timeout",s.timeout),s.timeout=s.timeout??this.timeout;let{bodyHeaders:x,body:g}=this.buildBody({options:s}),_=yield this.buildHeaders({options:e,method:o,bodyHeaders:x,retryCount:t});return{req:i(i(i(i(i({method:o,headers:_},s.signal&&{signal:s.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),this.fetchOptions??{}),s.fetchOptions??{}),url:m,timeout:s.timeout}})}buildHeaders(o){return d(this,arguments,function*({options:e,method:t,bodyHeaders:r,retryCount:s}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);let l=y([a,c(i(i({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),po()),{"OpenAI-Organization":this.organization,"OpenAI-Project":this.project}),yield this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(l),l.values})}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let r=y([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Br(e)}:u(this,An,"f").call(this,{body:e,headers:r})}};_s=C,An=new WeakMap,gs=new WeakSet,ii=function(){return this.baseURL!=="https://api.openai.com/v1"};C.OpenAI=_s;C.DEFAULT_TIMEOUT=6e5;C.OpenAIError=I;C.APIError=J;C.APIConnectionError=Me;C.APIConnectionTimeoutError=Fe;C.APIUserAbortError=V;C.NotFoundError=ct;C.ConflictError=ut;C.RateLimitError=ft;C.BadRequestError=it;C.AuthenticationError=at;C.InternalServerError=mt;C.PermissionDeniedError=lt;C.UnprocessableEntityError=dt;C.InvalidWebhookSignatureError=ye;C.toFile=Gr;C.Completions=ze;C.Chat=yr;C.Embeddings=Qe;C.Files=Ye;C.Images=Ze;C.Audio=wr;C.Moderations=tt;C.Models=et;C.FineTuning=Sr;C.Graders=Rr;C.VectorStores=$r;C.Webhooks=nt;C.Beta=Pr;C.Batches=Je;C.Uploads=Tr;C.Responses=kr;C.Realtime=Or;C.Conversations=vr;C.Evals=Er;C.Containers=Cr;C.Videos=rt;var Mr=class n extends C{constructor(m={}){var x=m,{baseURL:e=pe("OPENAI_BASE_URL"),apiKey:t=pe("AZURE_OPENAI_API_KEY"),apiVersion:r=pe("OPENAI_API_VERSION"),endpoint:s,deployment:o,azureADTokenProvider:a,dangerouslyAllowBrowser:l}=x,h=O(x,["baseURL","apiKey","apiVersion","endpoint","deployment","azureADTokenProvider","dangerouslyAllowBrowser"]);if(!r)throw new I("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if(typeof a=="function"&&(l=!0),!a&&!t)throw new I("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(a&&t)throw new I("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(h.defaultQuery=c(i({},h.defaultQuery),{"api-version":r}),e){if(s)throw new I("baseURL and endpoint are mutually exclusive")}else{if(s||(s=process.env.AZURE_OPENAI_ENDPOINT),!s)throw new I("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${s}/openai`}super(i(i({apiKey:a??t,baseURL:e},h),l!==void 0?{dangerouslyAllowBrowser:l}:{})),this.apiVersion="",this.apiVersion=r,this.deploymentName=o}buildRequest(r){return d(this,arguments,function*(e,t={}){if(Ma.has(e.path)&&e.method==="post"&&e.body!==void 0){if(!gt(e.body))throw new Error("Expected request body to be an object");let s=this.deploymentName||e.body.model||e.__metadata?.model;s!==void 0&&!this.baseURL.includes("/deployments")&&(e.path=`/deployments/${s}${e.path}`)}return Qt(n.prototype,this,"buildRequest").call(this,e,t)})}authHeaders(e){return d(this,null,function*(){return typeof this._options.apiKey=="string"?y([{"api-key":this.apiKey}]):Qt(n.prototype,this,"authHeaders").call(this,e)})}},Ma=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations","/batches","/images/edits"]);var Fa=n=>["/evento",n],La=()=>[0,.3];function Na(n,e){n&1&&(M(0,"div",16),fe(1,"ion-spinner",17),M(2,"div"),ie(3,"Leyendo contenido de la boleta..."),U()())}function Ua(n,e){if(n&1&&(M(0,"ion-text",18),ie(1),U()),n&2){let t=me();oe(),Pn(t.ocrError)}}function Ba(n,e){if(n&1){let t=Yt();M(0,"section",19)(1,"div",20),fe(2,"div",2),M(3,"div",21)(4,"div",22),ie(5),U(),M(6,"div",23)(7,"ion-label"),ie(8),vs(9,"clpCurrency"),U()(),M(10,"div",24)(11,"ion-button",25),de("click",function(){let s=ne(t).index,o=me();return se(o.editarItem(s))}),fe(12,"ion-icon",26),U()(),M(13,"div",24)(14,"ion-button",27),de("click",function(){let s=ne(t).index,o=me();return se(o.eliminarItem(s))}),fe(15,"ion-icon",28),U()()()()()}if(n&2){let t=e.$implicit;oe(5),As(" ",t.name," "),oe(3),Pn(Es(9,2,t.price))}}function ja(n,e){if(n&1){let t=Yt();M(0,"ion-content",29)(1,"div",30)(2,"div",31),de("click",function(){ne(t);let s=me();return se(s.abrirCamaraOGaleria(1))}),fe(3,"ion-icon",32),M(4,"span"),ie(5,"C\xE1mara"),U()(),M(6,"div",31),de("click",function(){ne(t);let s=me();return se(s.abrirCamaraOGaleria(2))}),fe(7,"ion-icon",33),M(8,"span"),ie(9,"Galer\xEDa"),U()()()()}}function Da(n,e){if(n&1){let t=Yt();M(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),ie(3,"Agregar item"),U()()(),M(4,"ion-content")(5,"ion-item")(6,"div",34)(7,"ion-label"),ie(8,"Nombre"),U(),M(9,"ion-input",35),En("ngModelChange",function(s){ne(t);let o=me();return vn(o.nombreItem,s)||(o.nombreItem=s),se(s)}),U()()(),M(10,"ion-item")(11,"div",34)(12,"ion-label"),ie(13,"Valor"),U(),M(14,"ion-input",36),En("ngModelChange",function(s){ne(t);let o=me();return vn(o.valorItem,s)||(o.valorItem=s),se(s)}),U()()(),M(15,"ion-footer")(16,"div",34)(17,"ion-button",37),de("click",function(){ne(t);let s=me();return se(s.agregarItem())}),ie(18,"Guardar"),U(),M(19,"ion-button",38),de("click",function(){ne(t);let s=me();return se(s.closeModal())}),ie(20,"Cancelar"),U()()()()}if(n&2){let t=me();oe(9),Cn("ngModel",t.nombreItem),oe(5),Cn("ngModel",t.valorItem),oe(3),ve("disabled",!t.nombreItem||!t.valorItem)}}var qa=je.azure?.endpoint??"",Wa=je.azure?.apiKey??"",Ha=je.azure?.model??"",Va=je.azure?.deployment??"",Ja=je.azure?.apiVersion??"2024-04-01-preview",b_=(()=>{let e=class e{constructor(){this.nombreItem=null,this.valorItem=null,this.showModal=!1,this.openModal=!1,this.indexItemEdit=null,this.image="",this.recognizedText="",this.actionSheet=Lr(zs),this.boletaParseResult=null,this.items=[],this.nuevoNombre="",this.nuevoMonto=null,this.ocrCargando=!1,this.ocrError="",this.base64textString="",this.route=Lr(ks),this.data=Lr(Zs)}abrirCamaraOGaleria(r){return d(this,null,function*(){try{let o=r===1?be.Camera:r===2?be.Photos:be.Prompt,a=yield no.getPhoto({quality:80,resultType:Tn.DataUrl,source:o});if(a&&a.dataUrl){let l=a.dataUrl.split(",")[1];yield this.procesarImagenBase64(l);return}}catch(o){console.warn("Camera error or not available, fallback to file input",o)}let s=document.getElementById("ocrInput");s?s.click():this.ocrError="No se encontr\u251C\u2502 el input para subir imagen."})}ngOnInit(){let r=Number(this.route.snapshot.paramMap.get("eventoId")),s=this.data.getEventById(r);s&&(this.evento=s,this.items=this.evento.items??[])}agregarItem(){if(this.indexItemEdit!==null){let r=this.items[this.indexItemEdit];if(!this.nombreItem||!this.nombreItem.trim()||!this.valorItem)return;r.name=this.nombreItem.trim(),r.price=Number(this.valorItem)}else{if(!this.nombreItem||!this.nombreItem.trim()||!this.valorItem)return;let r={id:Date.now(),name:this.nombreItem.trim(),price:Number(this.valorItem),participant:[]};this.items.push(r)}this.evento&&(this.evento.items=[...this.items],this.data.saveEvents()),this.nombreItem=null,this.valorItem=null,this.indexItemEdit=null,this.closeModal()}eliminarItem(r){this.items.splice(r,1),this.evento&&(this.evento.items=[...this.items],this.data.saveEvents())}editarItem(r){this.indexItemEdit=r,this.openAddModal();let s=this.items[r];this.nombreItem=s.name,this.valorItem=s.price}procesarImagen(r){return d(this,null,function*(){if(this.ocrError="",r&&r.target&&r.target.files){this.ocrCargando=!0;try{let o=r.target.files[0];if(!o){this.ocrCargando=!1;return}let a=new FileReader;a.onload=l=>{let h=l.target.result,m=btoa(h);this.procesarImagenBase64(m)},a.readAsBinaryString(o)}catch(o){console.error(o),this.ocrError="Error procesando la imagen.",this.ocrCargando=!1}return}if(!!window.cordova)try{yield(yield this.actionSheet.create({header:"Selecciona fuente",buttons:[{text:"C\u251C\xEDmara",icon:"camera",handler:()=>d(this,null,function*(){yield this.abrirCamaraOGaleria(1)})},{text:"Galer\u251C\xA1a",icon:"images",handler:()=>d(this,null,function*(){yield this.abrirCamaraOGaleria(2)})},{text:"Cancelar",icon:"close",role:"cancel"}]})).present()}catch(o){console.error(o),this.ocrError="No se pudo abrir la opci\u251C\u2502n de fuente."}else{let o=document.getElementById("ocrInput");o?o.click():this.ocrError="No se encontr\u251C\u2502 el input para subir imagen."}})}procesarImagenBase64(r){return d(this,null,function*(){this.base64textString=r,this.ocrCargando=!0,this.ocrError="";let s={endpoint:qa,apiKey:Wa,deployment:Va,apiVersion:Ja,dangerouslyAllowBrowser:!0},a=yield new Mr(s).chat.completions.create({messages:[{role:"user",content:[{type:"text",text:`Identifica los items de la boleta:

Extrae los items en formato JSON, donde cada item tiene 'name', 'cantidad' y 'price'. Si no hay cantidad, asume 1. Si no puedes identificar items, responde con un array vac\u251C\xA1o. Identifica el total de la boleta: Identifica el monto de la propina si es que existe Los items que tengan cantidad mayor a 1 deben ser considerados como m\u251C\u2551ltiples items en la respuesta , es decir todo el monto debe ser distribuido entre los items correspondientes y quedar todos en cantidad 1Revisa si el valor total coincide con la suma de los items y/o de la propina, si no cuadra deja la variable cuadratura en false, pero si calza dejalo en true Ejemplo de respuesta:
{"total": 4500,"propina": 500,"cuadratura": true,"items": [[{"name": "Item1", "cantidad": 2, "price": 3000}, {"name": "Item2", "cantidad": 1, "price": 1500}]]}`},{type:"image_url",image_url:{url:`data:image/jpeg;base64,${r}`}}]}],max_completion_tokens:16384,model:Ha});console.log(a.choices[0].message.content);let l;try{l=JSON.parse(a.choices[0].message.content)}catch{let x=a.choices[0].message.content.match(/\{.*\}/);if(x)l=JSON.parse(x[0]);else throw new Error("Formato de respuesta inv\u251C\xEDlido")}if(!l.items||!Array.isArray(l.items))throw new Error("La respuesta no contiene un array de items v\u251C\xEDlido");let h=l.items.map(m=>({name:m.name||"",price:Number(m.price)||0,cantidad:m.cantidad?Number(m.cantidad):1,participant:m.participant||[]}));this.evento&&(this.evento.items=[...h],this.data.saveEvents(),this.ocrCargando=!1,this.ngOnInit())})}openAddModal(){this.showModal=!0}closeModal(){this.showModal=!1,this.nuevoNombre="",this.valorItem=null}callGeminiWithImage(r,s){return d(this,null,function*(){let a=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${je.geminiApiKey}`,m=yield(yield fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{inline_data:{mime_type:"image/jpeg",data:r}},{text:s}]}]})})).json();if(m.candidates&&m.candidates.length>0)return m.candidates[0].content.parts[0].text;if(m.text)return m.text;throw new Error("Respuesta inesperada de Gemini: "+JSON.stringify(m))})}asignarParticipante(r,s){this.items[r].participant.push(s),this.evento&&(this.evento.items=[...this.items],this.data.saveEvents())}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=ys({type:e,selectors:[["app-items"]],viewQuery:function(s,o){if(s&1&&ws(Sn,5),s&2){let a;xs(a=Is())&&(o.content=a.first)}},decls:23,vars:12,consts:[["ocrInput",""],[3,"translucent"],["slot","start"],[3,"routerLink"],["slot","end"],["class","spin",4,"ngIf"],["color","danger",4,"ngIf"],["class","flex items-center gap-4 p-1",4,"ngFor","ngForOf"],["id","ocrInput","type","file","accept","image/*","capture","environment",2,"display","none",3,"change"],["slot","fixed",2,"bottom","100px","right","100px","position","absolute"],[3,"click"],["name","camera-sharp"],["slot","fixed",2,"bottom","100px","right","24px","position","absolute"],["name","add-outline"],["handle","true",1,"bottom-sheet-modal",3,"didDismiss","isOpen","initialBreakpoint","breakpoints"],[3,"didDismiss","isOpen"],[1,"spin"],["color","primary"],["color","danger"],[1,"flex","items-center","gap-4","p-1"],[1,"flex","items-center","gap-4","p-3","rounded-lg","bg-white","dark:bg-background-dark/50",2,"background-color","#06192D","width","100%"],[2,"align-items","center","display","flex","width","100%"],[2,"width","35%"],[2,"width","30%"],[2,"width","15%"],["color","primary",3,"click"],["name","create-outline"],["color","danger",3,"click"],["name","trash-outline"],[1,"bottom-sheet-content"],[1,"photo-container"],[1,"photo-option-card",3,"click"],["name","camera-outline"],["name","image-outline"],[1,"flex","flex-col","width-full","margin-top-5"],["autocapitalize","sentences","id","event-name","placeholder","Ej: Cena de fin de a\xF1o","value","",1,"form-input","flex","w-full","min-w-0","flex-1","resize-none","overflow-hidden","rounded-lg","text-[#212529]","dark:text-white","focus:outline-0","focus:ring-2","focus:ring-primary/50","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-background-dark","h-14","placeholder:text-[#6C757D]","p-[15px]","text-base","font-normal","leading-normal",3,"ngModelChange","ngModel"],["type","number","id","event-value","placeholder","Ej: 10000","value","",1,"form-input","flex","w-full","min-w-0","flex-1","resize-none","overflow-hidden","rounded-lg","text-[#212529]","dark:text-white","focus:outline-0","focus:ring-2","focus:ring-primary/50","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-background-dark","h-14","placeholder:text-[#6C757D]","p-[15px]","text-base","font-normal","leading-normal",3,"ngModelChange","ngModel"],["expand","block",3,"click","disabled"],["expand","block","color","medium",3,"click"]],template:function(s,o){if(s&1){let a=Yt();M(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),ie(3,"Items"),U(),M(4,"ion-buttons",2),fe(5,"ion-back-button",3),U(),fe(6,"ion-buttons",4),U()(),M(7,"ion-content"),Nr(8,Na,4,0,"div",5)(9,Ua,2,1,"ion-text",6)(10,Ba,16,4,"section",7),M(11,"input",8,0),de("change",function(h){return ne(a),se(o.procesarImagen(h))}),U()(),M(13,"ion-fab",9)(14,"ion-fab-button",10),de("click",function(){return ne(a),se(o.openModal=!0)}),fe(15,"ion-icon",11),U()(),M(16,"ion-fab",12)(17,"ion-fab-button",10),de("click",function(){return ne(a),se(o.openAddModal())}),fe(18,"ion-icon",13),U()(),M(19,"ion-modal",14),de("didDismiss",function(){return ne(a),se(o.openModal=!1)}),Nr(20,ja,10,0,"ng-template"),U(),M(21,"ion-modal",15),de("didDismiss",function(){return ne(a),se(o.closeModal())}),Nr(22,Da,21,3,"ng-template"),U()}s&2&&(ve("translucent",!0),oe(5),ve("routerLink",Cs(9,Fa,o.evento.id)),oe(3),ve("ngIf",o.ocrCargando),oe(),ve("ngIf",o.ocrError),oe(),ve("ngForOf",o.items),oe(9),ve("isOpen",o.openModal)("initialBreakpoint",.3)("breakpoints",Ps(11,La)),oe(2),ve("isOpen",o.showModal))},dependencies:[Ns,Ws,Xs,Gs,Sn,Hs,Vs,Bs,Us,Qs,Ys,Ls,Ms,Fs,Ss,$s,Ts,Os,Rs,js,Ds,qs,Ks,Js,eo],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{padding-bottom:var(--padding-bottom, 0px)!important}ion-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1.1rem}ion-content[_ngcontent-%COMP%]   ion-button[color=danger][_ngcontent-%COMP%]{margin-left:.5rem}ion-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{padding:8px 12px!important;background:#fff!important;border-radius:8px!important;font-size:16px!important;box-shadow:none!important;height:40px!important;appearance:textfield}body.keyboard-simulated[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{padding-bottom:320px!important}body.keyboard-simulated[_ngcontent-%COMP%]   .keyboard-overlay[_ngcontent-%COMP%]{display:block!important}.keyboard-overlay[_ngcontent-%COMP%], .keyboard-overlay-global[_ngcontent-%COMP%]{display:none;position:fixed;left:0;right:0;bottom:0;height:320px;background:#0000000d;z-index:9999}body.keyboard-simulated[_ngcontent-%COMP%]   .keyboard-overlay-global[_ngcontent-%COMP%]{display:block!important}.spin[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center}ion-spinner[_ngcontent-%COMP%]{width:28px;height:28px;stroke:#444;fill:#222}.keyboard-is-open[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--overflow: auto}ion-content[_ngcontent-%COMP%]{--padding-bottom: 90px}.footer-visible[_ngcontent-%COMP%]{position:fixed;bottom:env(safe-area-inset-bottom);left:0;right:0;background:var(--ion-background-color, #fff);border-top:1px solid var(--ion-color-medium);box-shadow:0 -2px 8px #0000001a;padding:10px 12px;z-index:9999}.form-row[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;width:100%;margin:0}.form-row[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{flex:1 1 35%}.form-row[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:0 0 25%}ion-list[_ngcontent-%COMP%]{margin-bottom:1.5rem}ion-modal[_ngcontent-%COMP%]{--width: 90vw;--height: 90vh}ion-footer[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;padding:1rem}.width-full[_ngcontent-%COMP%]{width:100%}.margin-top-5[_ngcontent-%COMP%]{margin-top:1.25rem}.ion-padding-bottom[_ngcontent-%COMP%]{--padding-bottom: 80px}.bottom-sheet-modal[_ngcontent-%COMP%]::part(backdrop){-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);background:#00000059}.bottom-sheet-content[_ngcontent-%COMP%]{--background: transparent;display:flex;justify-content:center;padding-top:20px}.photo-container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;width:100%;padding:0 20px}.photo-option-card[_ngcontent-%COMP%]{width:120px;height:120px;background:var(--ion-color-light);border-radius:20px;box-shadow:0 8px 25px #00000026;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:transform .15s ease,box-shadow .15s ease;cursor:pointer}.photo-option-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:42px;color:var(--ion-color-primary)}.photo-option-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:8px;font-size:16px;font-weight:500}.photo-option-card[_ngcontent-%COMP%]:active{transform:scale(.95);box-shadow:0 4px 14px #0003}@media (prefers-color-scheme: dark){.photo-option-card[_ngcontent-%COMP%]{background:#1e1e1e;box-shadow:0 8px 25px #ffffff0d}}']});let n=e;return n})();export{b_ as ItemsPage};
